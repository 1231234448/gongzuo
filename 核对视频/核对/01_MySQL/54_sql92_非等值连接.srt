1
00:00:00,922 --> 00:00:04,318
上节课我们讲解了多表查询当中的

2
00:00:04,318 --> 00:00:05,338
< No Speech >

3
00:00:05,338 --> 00:00:14,778
那我们知道所谓的等值连接其实指的就是对多个表当中的链接列以等号的方式来作为一个判断条件

4
00:00:14,778 --> 00:00:17,258
那么这就是一个等值连接对吧

5
00:00:17,258 --> 00:00:21,658
好那么这节课呢我们再来看一下什么是非等值连接

6
00:00:21,658 --> 00:00:26,538
那么其实我们通过这个名字也能知道这种链接方式的一个特点

7
00:00:26,538 --> 00:00:32,338
也就是说在做多个表的链接时对于链接列的判断我们用的不是等号

8
00:00:32,338 --> 00:00:37,338
除了等号以外的那么这些链接方式都是非等值连接

9
00:00:37,338 --> 00:00:43,978
那有同学会问了说老师如果不用等号还可以用什么来作为判断的条件呢

10
00:00:43,978 --> 00:00:48,378
那当然多了大于小于不等于

11
00:00:48,378 --> 00:00:54,578
这不都是可以作为一个判断链接的哪些数据应该有关联的这样的一个条件吗

12
00:00:54,578 --> 00:00:58,018
是吧好那我们看一下

13
00:00:58,018 --> 00:01:02,858
现在在这个图片当中安普拉一表当中他有last name有salary

14
00:01:02,858 --> 00:01:05,818
然后呢还有一个表叫job grade对吧

15
00:01:05,818 --> 00:01:12,378
在job grade当中呢有这个lowers salary有highs salary

16
00:01:12,378 --> 00:01:15,298
就是一个低工资一个高工资对不对

17
00:01:15,298 --> 00:01:21,898
那么现在呢我要想查询我这个员工的薪水他是属于哪个级别的

18
00:01:21,898 --> 00:01:23,938
那他的级别应该是什么呢

19
00:01:23,938 --> 00:01:29,258
如果你的薪水怎么的大于这个并且小于这个

20
00:01:29,258 --> 00:01:32,938
那你就是A级别的或者是大于等于或者是小于等于

21
00:01:32,938 --> 00:01:35,338
比对案的也可以对吧就是这个级别的

22
00:01:35,338 --> 00:01:38,138
那么如果是这个范围内的就是这个级别的

23
00:01:38,138 --> 00:01:43,138
哎那我们看现在对于这个查询他的数据也是来源于两个表

24
00:01:43,138 --> 00:01:45,018
那这肯定是一个多表查询了对吧

25
00:01:45,018 --> 00:01:49,978
那么在多表查询时对于这个数据的链接条件

26
00:01:49,978 --> 00:01:54,818
我用这个薪水和这个表的数据两个链去做一个条件的判断

27
00:01:54,818 --> 00:01:56,258
现在用的不是相等了

28
00:01:56,258 --> 00:01:58,418
不是相等那很显然不是等值链接了

29
00:01:58,418 --> 00:02:02,818
我们要用什么我们要用大于等于它小于等于它

30
00:02:02,818 --> 00:02:07,378
那这就是一个非等值只要不是用相等来判断都是非等值链接

31
00:02:07,378 --> 00:02:08,658
明白这些吧同学们

32
00:02:08,658 --> 00:02:12,098
所以这是一个典型的需要使用到非等值链接的方式

33
00:02:12,098 --> 00:02:13,658
来完成这样的一个查询

34
00:02:13,658 --> 00:02:17,258
来判断这个员工的工资级别是属于哪个级别的

35
00:02:17,258 --> 00:02:20,698
OK好我们来看非等值链接

36
00:02:20,698 --> 00:02:26,218
一个非等值链接是一种不同于等值操作的链接条件

37
00:02:26,218 --> 00:02:29,258
Employees表当中和Job Grids表当中

38
00:02:29,258 --> 00:02:30,206
A表

39
00:02:30,206 --> 00:02:31,386
< No Speech >

40
00:02:31,386 --> 00:02:34,626
Greed A表当中之间的关系是一个非等值链接的例子

41
00:02:34,626 --> 00:02:42,426
两个表之间的关系是Employees表当中的Salary列必须是JobGreed的LowSalary和HighSalary之间的值

42
00:02:42,426 --> 00:02:47,626
使用不同于等于的操作获得关系

43
00:02:47,626 --> 00:02:49,626
所以这就是一个非等值链接

44
00:02:49,626 --> 00:02:54,266
明白这意思吧?这是用非等值链接来完成的一个案例

45
00:02:54,266 --> 00:02:56,666
就是我们刚刚所看到的那个需求

46
00:02:56,666 --> 00:02:59,946
这个数据来源于Employees跟JobGreed

47
00:02:59,946 --> 00:03:08,786
然后呢,Between and,他的薪水如果是大于等于他,并且小于等于他

48
00:03:08,786 --> 00:03:12,386
那他就是哪个级别的就已经知道了

49
00:03:12,386 --> 00:03:16,226
明白这意思吧?所以你看,在整个链接过程当中

50
00:03:16,226 --> 00:03:20,946
我们并没有用到相等来作为两个表当中的某一个链的链接判断

51
00:03:20,946 --> 00:03:25,066
链接关系的一个指定,所以它就是一个非等值的,能理解吧?

52
00:03:25,066 --> 00:03:29,226
那么有人说,老师,非等值是不是必须得像这样有两个链

53
00:03:29,226 --> 00:03:33,386
拿一个链对两个链的链去做关系判断才是非等值

54
00:03:33,386 --> 00:03:34,906
不是的,跟你链的数量没关系

55
00:03:34,906 --> 00:03:41,534
比如说我用这个Salary去跟另一个表的Salary去做不等的判断

56
00:03:42,170 --> 00:03:49,010
那这也是非等值连接,只要是你判断两个列之间的关系的不是用等号的

57
00:03:49,010 --> 00:03:51,010
就是非等值,明白这些是吧?

58
00:03:51,010 --> 00:03:53,490
OK,好,我们来看一个示例

59
00:03:53,490 --> 00:04:01,210
示例一,首先创建job.grades这个表,包含loads.salary和hides.salary

60
00:04:01,210 --> 00:04:03,210
然后和grades.labor

61
00:04:03,210 --> 00:04:06,610
我们现在没有这个job.grades这个表,我们需要重新创建一个

62
00:04:06,610 --> 00:04:12,770
好,那我们就把这个创建语句直接放到我们的查询当中去执行一下

63
00:04:12,770 --> 00:04:14,878
让他先把这个表创建出来

64
00:04:14,878 --> 00:04:18,042
< No Speech >

65
00:04:18,042 --> 00:04:20,042
OK,然后我们看一下啊

66
00:04:20,042 --> 00:04:23,578
< No Speech >

67
00:04:23,578 --> 00:04:26,138
是不是多了一个jobgrid对吧?OK

68
00:04:26,138 --> 00:04:30,698
好了 我们有这个表以后呢插入一些这个基础数据

69
00:04:30,698 --> 00:04:36,698
工资1000到2999的它的级别是A 2000到499的是B

70
00:04:36,698 --> 00:04:45,258
5000到7999是C 8000到12000的是D

71
00:04:45,258 --> 00:04:51,098
可以吧 我们把这些数据添加到我们的这个数据表当中

72
00:04:51,098 --> 00:04:51,326
好 我们уска ن基础 就是N 基础

73
00:04:51,326 --> 00:04:56,410
< No Speech >

74
00:04:56,410 --> 00:04:58,010
好我们看一下啊

75
00:04:58,010 --> 00:05:02,682
< No Speech >

76
00:05:02,682 --> 00:05:04,082
这个表明不对啊

77
00:05:04,082 --> 00:05:06,082
表明是Job Grid

78
00:05:06,082 --> 00:05:13,818
< No Speech >

79
00:05:13,818 --> 00:05:15,454
OK 我们换一下

80
00:05:15,454 --> 00:05:23,354
< No Speech >

81
00:05:23,354 --> 00:05:25,594
已经插进来了是吧我们可以看一下啊

82
00:05:26,354 --> 00:05:28,354
JobGrids双击打开这个表

83
00:05:28,354 --> 00:05:31,166
看到了吗数据已经进来了啊

84
00:05:31,166 --> 00:05:33,434
< No Speech >

85
00:05:33,434 --> 00:05:40,274
OK,然后我们再来看势力三,势力三要求查询所有雇员的薪水级别

86
00:05:40,986 --> 00:05:49,466
雇员信息在哪?薪水是不是得在雇员表里,在employees表里,对吧?薪水级别在哪?是不是在job grades里面?

87
00:05:49,466 --> 00:05:59,306
那怎么判断薪水的级别呢?是不是用薪水,是吧?去大于等于最低,并且小于等于最高,那是不是就是between and?

88
00:05:59,306 --> 00:06:10,946
对吧?同学们,哎,那这样呢,我们是不是就可以用一个多表连接去写出这个查询了?非常的简单啊,啊,呃,先select,然后from,然后where,是吧?

89
00:06:10,946 --> 00:06:24,586
ok,from定位哪个表?现在的数据查询来源于两个表,一个是employee,薪水在这里,是吧?然后还有一个job,啊,grade,啊,叫什么?我们看一下啊,叫对,不是job grade。

90
00:06:24,586 --> 00:06:26,138
< No Speech >

91
00:06:26,138 --> 00:06:27,578
是Job Grid

92
00:06:27,578 --> 00:06:33,914
< No Speech >

93
00:06:33,914 --> 00:06:36,474
然后起个j

94
00:06:36,474 --> 00:06:37,274
对吧

95
00:06:37,274 --> 00:06:40,114
然后接下来呢我们这里要做一个判断了

96
00:06:40,114 --> 00:06:40,834
什么判断呢

97
00:06:40,834 --> 00:06:42,234
一点 salary

98
00:06:42,234 --> 00:06:43,594
薪水是吧

99
00:06:43,594 --> 00:06:44,674
比特

100
00:06:44,674 --> 00:06:45,954
谁呢

101
00:06:45,954 --> 00:06:47,834
在job的

102
00:06:47,834 --> 00:06:50,878
我们看一下这个表明写错了吗

103
00:06:50,878 --> 00:06:56,506
< No Speech >

104
00:06:56,506 --> 00:06:58,946
他没有提示是吧 没提示我们自己写吧

105
00:06:59,466 --> 00:07:05,306
job.lostest下滑械SL

106
00:07:05,306 --> 00:07:11,710
然后按的j.heist下滑械

107
00:07:11,710 --> 00:07:12,954
< No Speech >

108
00:07:12,954 --> 00:07:19,314
对吧 这是他的一个查询条件 然后他要什么呢 他要雇员的名字以及薪水的级别

109
00:07:19,314 --> 00:07:26,434
是吧 雇员的名字1.last name 薪水的级别g.薪水的级别叫什么

110
00:07:26,434 --> 00:07:33,794
是不是great level 是吧 小螺旋level ok这样就可以了

111
00:07:33,794 --> 00:07:39,394
然后我们执行 看到了吗 现在已经查到了这些人的薪水级别了

112
00:07:39,394 --> 00:07:46,314
看到了吗 他们是a b c d就已经搞定了 那么我们看看在这个多表查询当中

113
00:07:46,314 --> 00:07:52,674
我们并没有使用等于去做链接条件的判断 我们用的是大于等于并且小于等于

114
00:07:52,674 --> 00:07:57,598
这就是一个典型的非等值链接了 明白这些吗同学们

115
00:07:58,170 --> 00:08:08,570
好,我们来看一下实时效果反馈,如下说法,错误的是,A,一个非等值链接是一种使用等值作为链接条件的

116
00:08:08,570 --> 00:08:09,626
< No Speech >

117
00:08:09,626 --> 00:08:15,226
B,一个非等值连接是使用一种大于作业连接条件的

118
00:08:15,226 --> 00:08:21,146
C,一个非等值连接是使用一种小于作业连接条件的

119
00:08:21,146 --> 00:08:25,306
D,一个非等值连接是使用一种不等于作业连接条件的

120
00:08:25,306 --> 00:08:31,866
那么在以下这四种说法当中,错误的是哪一种呢?很显然是第一种

121
00:08:31,866 --> 00:08:36,826
一个非等值连接是使用等值作业连接的,这根本不对

122
00:08:36,826 --> 00:08:41,946
用等值作业连接的叫等值连接,所以这个A是错误的

123
00:08:41,946 --> 00:08:44,106
答案A没有问题

124
00:08:44,106 --> 00:08:48,186
好,同学们,那么以上我们就讲解了什么是非等值连接

125
00:08:48,186 --> 00:08:50,426
好,那我们这节课就到这

