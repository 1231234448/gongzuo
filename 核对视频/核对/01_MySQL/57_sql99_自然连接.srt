1
00:00:00,858 --> 00:00:04,350
这节课我们再来讲解一下SQL99当中的

2
00:00:05,338 --> 00:00:09,498
同学们这块注意啊,这是自然连接,可不是自连接啊

3
00:00:09,498 --> 00:00:11,738
自然连接跟自连接是两回事啊

4
00:00:11,738 --> 00:00:13,898
自然连接,nature join

5
00:00:13,898 --> 00:00:15,738
那么创建自然连接

6
00:00:15,738 --> 00:00:22,174
nature join子句是基于两个表之间有相同名字的所有列

7
00:00:22,682 --> 00:00:29,122
它从两个表中选择在所有匹配列当中有相等值的行

8
00:00:29,122 --> 00:00:33,082
如果有相同名字的列数据类型不同,返回一个错误

9
00:00:33,082 --> 00:00:37,682
什么意思呢?这里我来给大家详细的说一下什么叫自然临机

10
00:00:37,682 --> 00:00:40,158
比如说我现在有两个表

11
00:00:40,826 --> 00:00:45,626
看一下我现在有两个表,一个A表一个B表

12
00:00:45,626 --> 00:00:50,826
那么现在呢,我要用A表,我在A表去连接B表时

13
00:00:50,826 --> 00:00:53,546
如果用的是natural join,会怎么样呢?

14
00:00:53,546 --> 00:00:57,706
那么这个时候自然连接会去找在A表当中

15
00:00:57,706 --> 00:01:04,586
他去找A表当中的哪些列的列名和B表当中的哪些列的列名相同

16
00:01:04,586 --> 00:01:10,906
并且类型也相同,那么他会自动的把这两个列作为一个连接条件

17
00:01:10,906 --> 00:01:13,466
用什么符号呢?用的是等号

18
00:01:13,466 --> 00:01:21,546
也就是说他会把两个表当中列名相同以及类型相同的列作为一个等值连接的一部分

19
00:01:21,546 --> 00:01:25,546
明白吧?那么如果两个表有多个列名以及类型相同呢?

20
00:01:25,546 --> 00:01:29,946
那么他会把这些列逐一的添加到连接条件当中

21
00:01:29,946 --> 00:01:35,546
并且条件跟条件之间是暗的关系,而且用的都是等值连接

22
00:01:35,546 --> 00:01:38,426
明白这意思吧?所以说自然连接指的是什么?

23
00:01:38,426 --> 00:01:47,866
自然连接指的就是会去自动的识别两个表当中相同的列的列名以及类型相同的列作为等值连接的一部分

24
00:01:47,866 --> 00:01:50,346
这就是自然连接,能明白吧?

25
00:01:50,346 --> 00:01:56,106
那么如果你的两个表当中有列名相同且类型不相同时

26
00:01:56,106 --> 00:02:00,186
那么他在执行自然连接时会返回一个错误

27
00:02:00,186 --> 00:02:02,906
明白这意思吧?这是自然连接

28
00:02:02,906 --> 00:02:04,426
好,我们来看一下

29
00:02:04,426 --> 00:02:10,186
连接只能发生在两个表当中有相同名字和数据类型的列上

30
00:02:10,186 --> 00:02:13,706
名字相同同时数据类型也得相同,否则会有错误的

31
00:02:13,706 --> 00:02:20,586
如果列有相同的名字,但是数据类型不同,natural joint语法会引起错误

32
00:02:20,586 --> 00:02:25,866
明白这意思吧?好,我们来看一下用自然连接完成这样的一个操作

33
00:02:25,866 --> 00:02:32,266
首先我去查询,我用自然连接去连接departments和locationsid

34
00:02:32,266 --> 00:02:36,106
那么在departments表当中有一个locationsid

35
00:02:36,106 --> 00:02:38,666
我们看一下表结构

36
00:02:38,666 --> 00:02:42,746
departments表当中是不是有一个locationsid

37
00:02:42,746 --> 00:02:46,026
这个列的名就叫locationsh-id,而且是int类型的

38
00:02:46,026 --> 00:02:48,026
对吧?好,我们再来看locations

39
00:02:48,026 --> 00:02:51,066
locations表里面也有一个locationsid

40
00:02:51,066 --> 00:02:55,146
名字叫locationsid,对吧?然后也是int类型的

41
00:02:55,146 --> 00:02:59,626
那么我现在如果想用locationsid作为一个连接条件

42
00:02:59,626 --> 00:03:03,466
在查询departments和locations表的时候

43
00:03:03,466 --> 00:03:06,186
想使用locationsid作为一个连接条件

44
00:03:06,186 --> 00:03:09,546
那么我们就可以使用自然连接了,natural joint了

45
00:03:09,546 --> 00:03:11,306
是吧?怎么写呢?我们就写

46
00:03:11,306 --> 00:03:19,626
select a 姓from,department,nature joint,location

47
00:03:19,626 --> 00:03:26,266
后面要不要给定department的locationid等于location的locationid呢?

48
00:03:26,266 --> 00:03:30,986
不用了,因为natural joint会自动帮助我们去做同列名

49
00:03:30,986 --> 00:03:33,866
并且同类型的这样列的一个等值连接

50
00:03:33,866 --> 00:03:35,386
明白这一次吧?同学们

51
00:03:35,386 --> 00:03:40,986
所以我们这个语句可以简化成from,department,nature joint,location

52
00:03:40,986 --> 00:03:44,266
这样它就会自动的通过locationid去连接了

53
00:03:44,266 --> 00:03:48,346
因为locationid在两个表当中列名相同,且类型相同

54
00:03:48,346 --> 00:03:50,586
明白吗?同学们,这个很好理解

55
00:03:50,586 --> 00:03:52,094
好,我们再看一下

56
00:03:52,986 --> 00:03:59,066
在图片的例子当中,location表被locationid列连接到department表

57
00:03:59,066 --> 00:04:04,426
在这两个表当中,唯一名字相同的列就是location-id

58
00:04:04,426 --> 00:04:11,466
如果存在其他同类型的列,自然连接会使用等值连接的方式连接它们

59
00:04:11,466 --> 00:04:14,826
那么比如说这里有多个列名字相同且类型相同了

60
00:04:14,826 --> 00:04:18,666
那么这时候natural join会继续的把它们作为一个连接条件

61
00:04:18,666 --> 00:04:23,386
那么仍然用的是等值连接,然后连接条件的关系为AND

62
00:04:23,386 --> 00:04:27,066
因为多条件的时候肯定要有一个条件与条件的关系

63
00:04:27,066 --> 00:04:29,786
那么用的AND来作为多条件的关系

64
00:04:29,786 --> 00:04:30,746
明白这意思吧?

65
00:04:30,746 --> 00:04:34,186
那么自然连接也可以写成等值连接的

66
00:04:34,186 --> 00:04:41,226
它只是一种等值连接的简化形式,但是要求你必须得有列名相同、类型相同

67
00:04:41,226 --> 00:04:42,266
明白这意思吧?

68
00:04:42,266 --> 00:04:45,866
那么其实这个等值连接我们在开发的过程当中用的多不多呢?

69
00:04:45,866 --> 00:04:48,746
其实我们这个等值连接在开发的时候用的也不是很多

70
00:04:48,746 --> 00:04:50,586
因为我们要用等值连接有前提条件

71
00:04:50,586 --> 00:04:51,546
什么前提条件呢?

72
00:04:51,546 --> 00:04:56,506
你在设计表的时候,你就要想到未来我要用哪个表的

73
00:04:56,506 --> 00:04:58,746
这几个表的哪个列去作为等值连接的列

74
00:04:58,746 --> 00:05:01,866
那我就必须得保证它们的名字相同且类型相同

75
00:05:01,866 --> 00:05:02,666
对吧?

76
00:05:02,666 --> 00:05:07,306
而且要考虑到一个表里只有那么一个是最好的

77
00:05:07,306 --> 00:05:10,586
如果有多个,那可能有多个列名相同且类型相同的

78
00:05:10,586 --> 00:05:12,826
那可能查询的数据就不是我们想要的了

79
00:05:12,826 --> 00:05:17,546
所以这些都是我们在使用等值连接之前就要去做的一些铺垫工作

80
00:05:17,546 --> 00:05:18,826
明白这意思吧?

81
00:05:18,826 --> 00:05:22,426
那么其实我们在设计表的时候,这些也未必都能想到

82
00:05:22,426 --> 00:05:25,146
所以我们一般情况下在去做这样查询的时候

83
00:05:25,146 --> 00:05:26,746
有多表查询的时候

84
00:05:26,746 --> 00:05:29,786
能用等值连接的肯定用等值连接更方便一些

85
00:05:29,786 --> 00:05:32,026
因为等值连接没有这些前置性的要求

86
00:05:32,026 --> 00:05:34,746
它不要求你的列名必须得同名

87
00:05:34,746 --> 00:05:37,546
你不同名也可以的,明白这意思吧?

88
00:05:37,546 --> 00:05:38,906
好,那我们看一下

89
00:05:38,906 --> 00:05:42,906
质量连接也可以写成等值连接,就是我们刚刚的这个例子

90
00:05:42,906 --> 00:05:43,946
看

91
00:05:43,946 --> 00:05:48,826
select departmentid, departmentname, d.locationid, l.city

92
00:05:48,826 --> 00:05:52,186
from departmentd, location l, where

93
00:05:52,186 --> 00:05:56,026
注意看,d.locationid等于l.locationid

94
00:05:56,026 --> 00:05:59,786
是吧?这个查询出来的结果跟我们刚刚在图片里所写的

95
00:05:59,786 --> 00:06:02,266
这个natural join查出来的结果是一样的

96
00:06:02,266 --> 00:06:03,386
明白这意思吧?

97
00:06:03,386 --> 00:06:06,266
所以说只是写起来可能会有一些变化

98
00:06:06,266 --> 00:06:10,266
用等值连接写起来相比叫natural join要稍稍复杂一些

99
00:06:10,266 --> 00:06:11,706
明白这意思吧?

100
00:06:11,706 --> 00:06:13,226
好,我们来看一个事例

101
00:06:13,226 --> 00:06:19,226
使用质量连接查询所有有部门的雇员的名字以及部门名称

102
00:06:19,226 --> 00:06:20,586
你看看他要什么呀?

103
00:06:20,586 --> 00:06:22,906
是不是要雇员的名字以及部门名称啊?

104
00:06:22,906 --> 00:06:25,226
雇员名字在employee表当中

105
00:06:25,226 --> 00:06:27,386
部门名称在department表当中

106
00:06:27,386 --> 00:06:29,706
是吧?我们看一下这两个表

107
00:06:29,706 --> 00:06:32,906
那么我们先想一下,如果用等值连接该怎么去做?

108
00:06:32,906 --> 00:06:38,186
用等值连接是不是用雇员的表当中的department id

109
00:06:38,186 --> 00:06:40,346
他不有一个department id吗?

110
00:06:40,346 --> 00:06:44,798
雇员的部门编号,对吧?在这呢

111
00:06:44,798 --> 00:06:45,850
< No Speech >

112
00:06:45,850 --> 00:06:50,850
安普拉易的部门编号departmentid是吧

113
00:06:50,850 --> 00:06:54,410
用它去链接department表的departmentid

114
00:06:54,410 --> 00:06:57,170
然后去取department表的departmentname不就可以了

115
00:06:57,170 --> 00:06:57,770
对不对

116
00:06:57,770 --> 00:06:59,170
这是用等值链接来做

117
00:06:59,170 --> 00:07:00,450
但是现在你会发现

118
00:07:00,450 --> 00:07:07,370
安普拉易表当中的departmentid和department表当中的departmentid名字相同且链接相同

119
00:07:07,370 --> 00:07:10,370
而且这两个表只有这个链名是相同的

120
00:07:10,370 --> 00:07:16,890
那我们是不是就可以使用natural join去做这样的一个链接了对不对

121
00:07:16,890 --> 00:07:17,890
好我们来写一个

122
00:07:18,874 --> 00:07:25,754
然后他要什么呢?我们先把结构打进去,from哪个表?是不是employee啊?

123
00:07:25,754 --> 00:07:32,314
然后现在我们要用他的departmentid去连接,连接谁呢?department这个表

124
00:07:32,314 --> 00:07:40,318
那恰恰他们这两个列都叫departmentid,那我是不是就可以使用natural join是吧?

125
00:07:40,318 --> 00:07:41,626
< No Speech >

126
00:07:41,626 --> 00:07:46,826
好 然后后面给谁呢?Departments这个料 就OK了

127
00:07:46,826 --> 00:07:49,746
看到了吗?然后要什么呢?我们看一下啊

128
00:07:49,746 --> 00:07:50,970
< No Speech >

129
00:07:50,970 --> 00:07:54,970
它要呃员工的last name起个别名

130
00:07:54,970 --> 00:07:57,210
< No Speech >

131
00:07:57,210 --> 00:08:04,250
1.lastname,d.departmentname

132
00:08:04,250 --> 00:08:06,046
2.lastname,d.departmentname

133
00:08:06,554 --> 00:08:12,634
一共查出了32条,是吧?好,那我们现在把这个语句改成等值链接去实现一下

134
00:08:12,634 --> 00:08:14,654
copy一下拿过来

135
00:08:15,546 --> 00:08:18,226
好 现在把这改一下

136
00:08:18,778 --> 00:08:20,978
把NatureJoin换成等值连接

137
00:08:20,978 --> 00:08:27,658
那就是5月2,1.departmentid等于d.departmentid

138
00:08:27,658 --> 00:08:30,458
我们刚刚执行的时候查询出32条数据

139
00:08:30,458 --> 00:08:32,458
我们换成等值连接再运行

140
00:08:32,458 --> 00:08:34,458
是不是同样32条数据

141
00:08:34,458 --> 00:08:34,978
是吧

142
00:08:34,978 --> 00:08:38,298
所以说我们这个NatureJoin也可以用等值连接来表示的

143
00:08:38,298 --> 00:08:38,858
好

144
00:08:38,858 --> 00:08:41,378
我们来看一下这个实时效果反馈

145
00:08:41,378 --> 00:08:42,698
在自然连接中

146
00:08:42,698 --> 00:08:46,178
如果有多个类型与名称相同的链

147
00:08:46,178 --> 00:08:48,778
在连接时连接条件的关系为什么

148
00:08:48,778 --> 00:08:50,138
我们看一下这个题

149
00:08:50,138 --> 00:08:52,138
我一再强调自然连接当中

150
00:08:52,138 --> 00:08:55,738
如果两个表当中有多个列的列名以及类型都相同

151
00:08:55,738 --> 00:08:58,378
那么它们都会作为连接的一个条件的一部分

152
00:08:58,378 --> 00:08:58,818
对吧

153
00:08:58,818 --> 00:09:00,178
那么既然是多条件的了

154
00:09:00,178 --> 00:09:01,498
肯定有条件的关系

155
00:09:01,498 --> 00:09:01,898
对吧

156
00:09:01,898 --> 00:09:03,418
那么在自然连接当中

157
00:09:03,418 --> 00:09:06,618
多个条件的关系会用什么逻辑符来表示呢

158
00:09:06,618 --> 00:09:11,458
A or B in C not D and

159
00:09:11,458 --> 00:09:12,218
应该是哪个

160
00:09:12,218 --> 00:09:14,418
很显然是and

161
00:09:14,418 --> 00:09:14,978
对吧

162
00:09:14,978 --> 00:09:21,218
自然连接会把所有的连接列的条件都用and的方式来作为一个条件的连接

163
00:09:21,218 --> 00:09:21,658
好

164
00:09:21,658 --> 00:09:23,018
答案是D

165
00:09:23,018 --> 00:09:23,778
好同学们

166
00:09:23,778 --> 00:09:27,818
以上我们就讲解了SQL99当中的自然连接的一个使用

167
00:09:27,818 --> 00:09:28,738
也是比较简单的

168
00:09:28,738 --> 00:09:29,618
好同学们

169
00:09:29,618 --> 00:09:31,678
我们这节课就到这

