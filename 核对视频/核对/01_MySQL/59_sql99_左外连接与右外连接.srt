1
00:00:00,000 --> 00:00:01,210
< No Speech >

2
00:00:01,210 --> 00:00:07,570
这节课我们再来讲解一下SQL99当中的外连接查询alter join

3
00:00:07,570 --> 00:00:09,810
那么什么是外连接查询呢?

4
00:00:09,810 --> 00:00:14,810
这里我教大家一个小窍门,来理解外连接查询

5
00:00:14,810 --> 00:00:19,410
我们看一下,外连接的单词是不是叫alter join呢?

6
00:00:19,410 --> 00:00:23,010
那我们就从这个单词入手,我们看这个alter

7
00:00:23,010 --> 00:00:24,890
alter直译过来表示什么意思?

8
00:00:24,890 --> 00:00:30,690
是不是外面的、外边的、以外的,我们都可以用alter来表示

9
00:00:30,690 --> 00:00:32,490
那么我们就可以理解为

10
00:00:32,490 --> 00:00:36,490
比如说现在我用外连接去做两个表的查询

11
00:00:36,490 --> 00:00:43,610
比如说我这有一个A表,有一个B表,看一下这是A表,这是B表

12
00:00:43,610 --> 00:00:48,830
比如说我在做AB两个表,连接查询时,我用的是外连接查询

13
00:00:48,830 --> 00:00:50,394
< No Speech >

14
00:00:50,394 --> 00:00:59,634
这个时候他除了可以查到我们所关心的或者是我们条件当中所给定的这一部分数据以外

15
00:00:59,634 --> 00:01:02,114
注意这是外连接的作用了

16
00:01:02,114 --> 00:01:06,394
除了能够查到我们所给定的这些数据以外

17
00:01:06,394 --> 00:01:12,154
还能查到两个表当中的那些不匹配的数据

18
00:01:12,154 --> 00:01:13,658
< No Speech >

19
00:01:13,658 --> 00:01:16,938
明白了意思吗?明白了意思吗?这就是外联机的作用

20
00:01:16,938 --> 00:01:23,698
那到底是显示的A表的不匹配的数据还是显示B表的不匹配的数据呢?

21
00:01:24,506 --> 00:01:26,826
这要取决于你用的哪个外连接了

22
00:01:26,826 --> 00:01:29,066
如果你用的是左外连接

23
00:01:29,066 --> 00:01:31,466
并且A表在你的左侧

24
00:01:31,466 --> 00:01:32,866
那么就显示

25
00:01:32,866 --> 00:01:37,426
除了显示这个A表当中匹配的数据以外

26
00:01:37,426 --> 00:01:40,286
还会显示A表当中那些不匹配的数据

27
00:01:40,794 --> 00:01:54,994
没问题是吧?如果你用的是右外连接,而且B表在你的右外连接关键字的右侧,那则显示B表当中满足或者叫匹配的数据,同时还显示出B表当中不匹配的数据

28
00:01:54,994 --> 00:01:56,026
< No Speech >

29
00:01:56,026 --> 00:02:04,146
明白这意思吧?那如果我两侧都显示呢?A表的不匹配的数据我也显示,B表的不匹配的数据我也显示

30
00:02:04,146 --> 00:02:06,626
那这就是全外连接了

31
00:02:07,322 --> 00:02:16,162
明白了吗?同学们,这个所谓的外连接指的是什么?就是当我们查到匹配的结果集以外的数据

32
00:02:16,162 --> 00:02:23,362
除了查到匹配的结果集,还能显示除了它以外的那些不匹配的数据,就叫外连接

33
00:02:23,362 --> 00:02:30,882
到底显示谁的表当中的不匹配的数据,那看你用的是左外还是右外,以及表示在左面还是右面

34
00:02:30,882 --> 00:02:33,882
明白这些什么东西吗?这就是外连接

35
00:02:33,882 --> 00:02:44,402
内与外连接,在SQL 1999版当中,连接两个表仅返回匹配的行的连接,我们称之为内连接

36
00:02:44,402 --> 00:02:52,682
我们之前讲过了,在连接当中,符合我们连接条件的数据,查出来的这样的数据,都是用内连接来实现的

37
00:02:52,682 --> 00:02:57,122
这里是不包含那些不符合条件的数据,内连接肯定是查不到的

38
00:02:57,122 --> 00:03:05,162
那么在两个表之间的连接,返回内连接的结果,同时还能返回不匹配的行

39
00:03:05,162 --> 00:03:11,402
就是除了匹配的结果以外,还有那些不匹配的,这个时候就得用到外连接了

40
00:03:11,402 --> 00:03:16,766
那么是用左或者是右表来连接,称之为左或者是右外连接

41
00:03:17,466 --> 00:03:22,746
那么在两个表之间的链接返回内连的结果

42
00:03:22,746 --> 00:03:27,306
同时还返回左和右链接称为全外连接

43
00:03:27,306 --> 00:03:30,466
所以全外连接就是除了返回匹配的结果以外

44
00:03:30,466 --> 00:03:34,546
两个表不匹配的数据都显示出来

45
00:03:34,546 --> 00:03:35,946
那这就是全外连接

46
00:03:35,946 --> 00:03:39,786
但是在MySQL当中是不支持全外连接的

47
00:03:39,786 --> 00:03:43,706
但是我们可以使用其他的方式来实现全外连接

48
00:03:43,706 --> 00:03:44,746
明白这一次吧

49
00:03:44,746 --> 00:03:45,466
好

50
00:03:45,466 --> 00:03:46,986
那我们再往下看

51
00:03:46,986 --> 00:03:50,306
这里我们还要先了解一个名词

52
00:03:50,306 --> 00:03:52,266
叫孤儿数据

53
00:03:52,266 --> 00:03:54,466
那么什么叫孤儿数据呢

54
00:03:54,466 --> 00:03:58,706
孤儿数据是指被链接的列的值为空的数据

55
00:03:58,706 --> 00:04:02,106
其实指的就是那些不匹配的数据

56
00:04:02,106 --> 00:04:06,306
在外连接当中所查到的那些不匹配的数据

57
00:04:06,306 --> 00:04:08,186
我们就称之为孤儿数据

58
00:04:08,186 --> 00:04:10,706
如果我们用的是左外连接

59
00:04:10,706 --> 00:04:12,186
并且A表在左

60
00:04:12,186 --> 00:04:14,266
那么这个查询结果当中

61
00:04:14,266 --> 00:04:20,026
包含了A表所匹配的数据以及A表当中的孤儿数据

62
00:04:20,026 --> 00:04:21,266
这么说能明白吧

63
00:04:21,266 --> 00:04:24,346
孤儿数据就是那些不匹配的数据

64
00:04:24,346 --> 00:04:25,266
Open data

65
00:04:25,266 --> 00:04:25,906
OK

66
00:04:25,906 --> 00:04:26,306
好

67
00:04:26,306 --> 00:04:28,266
那我们先来看左外连接

68
00:04:28,266 --> 00:04:32,266
左外连接它的关键字是left outer join

69
00:04:32,266 --> 00:04:33,706
我们看这个图

70
00:04:33,706 --> 00:04:34,786
左外连接

71
00:04:34,786 --> 00:04:37,906
当我们用左外连接去连接A表和B表时

72
00:04:37,906 --> 00:04:41,106
并且A表在你左外连接关键字的左侧

73
00:04:41,106 --> 00:04:42,626
那指的就是用左外连接

74
00:04:42,626 --> 00:04:49,066
那么这个时候A表的数据除了会显示出满足查询条件的数据以外

75
00:04:49,066 --> 00:04:51,946
还会显示出A表的所有的孤儿数据

76
00:04:51,946 --> 00:04:55,906
也就是那些不匹配查询条件的数据

77
00:04:55,906 --> 00:04:57,786
明白这意思吧同学们

78
00:04:57,786 --> 00:04:58,946
这是左外连接

79
00:04:58,946 --> 00:05:01,626
我们来看一下左外连接的语法格式

80
00:05:01,626 --> 00:05:04,306
首先select from这都没有变

81
00:05:04,306 --> 00:05:05,786
注意看from后面

82
00:05:05,786 --> 00:05:10,786
比如说现在我想用employee去连接department

83
00:05:10,786 --> 00:05:12,226
并且用左外连接

84
00:05:12,226 --> 00:05:14,586
你看那我就from后面

85
00:05:14,586 --> 00:05:17,466
employee你该起别名起别名

86
00:05:17,466 --> 00:05:20,666
然后用left outer join的关键字

87
00:05:20,666 --> 00:05:21,786
然后连谁呢

88
00:05:21,786 --> 00:05:24,866
用左外连接连department这个表

89
00:05:24,866 --> 00:05:25,906
那我问大家

90
00:05:25,906 --> 00:05:27,146
现在谁是左表

91
00:05:27,146 --> 00:05:28,306
你用的是左外连接

92
00:05:28,306 --> 00:05:29,226
谁是左表

93
00:05:29,226 --> 00:05:31,986
我们是不是就要看这个left outer join

94
00:05:31,986 --> 00:05:33,186
它的左右

95
00:05:33,186 --> 00:05:35,426
在这个关键字的左侧的是谁

96
00:05:35,426 --> 00:05:36,986
employee对吧

97
00:05:36,986 --> 00:05:39,986
那你用左外连接来做的这个查询

98
00:05:39,986 --> 00:05:41,706
那employee作为左表

99
00:05:41,706 --> 00:05:42,706
那么也就是说

100
00:05:42,706 --> 00:05:46,146
在employee表当中的孤儿数据会被显示出来

101
00:05:46,146 --> 00:05:49,630
而department表中的孤儿数据是不会显示出来的

102
00:05:50,170 --> 00:05:54,490
明白这次吧?所以你看查的数据安普拉一表当中有个grand

103
00:05:54,490 --> 00:05:56,490
这个人是没有部门的

104
00:05:56,490 --> 00:05:57,754
< No Speech >

105
00:05:57,754 --> 00:05:59,754
按照我们正常的等值连接来看

106
00:05:59,754 --> 00:06:01,594
这个grant数据肯定是查不出来的

107
00:06:01,594 --> 00:06:03,394
因为他都没有department的ID

108
00:06:03,394 --> 00:06:04,594
对吧

109
00:06:04,594 --> 00:06:05,434
你看看这

110
00:06:05,474 --> 00:06:06,834
他都没有departmentID

111
00:06:07,034 --> 00:06:07,834
用等值连接

112
00:06:07,874 --> 00:06:09,434
这个数据肯定是查不出来的

113
00:06:09,474 --> 00:06:12,074
但是如果我们现在用的是左外连接

114
00:06:12,634 --> 00:06:14,434
那么我们除了可以查出

115
00:06:14,474 --> 00:06:15,994
那些有部门的员工以外

116
00:06:16,034 --> 00:06:18,754
还可以查出没有部门ID的员工

117
00:06:18,794 --> 00:06:19,794
这就是孤儿数据

118
00:06:20,634 --> 00:06:22,074
在A表当中的孤儿数据

119
00:06:22,074 --> 00:06:22,794
不匹配的数据

120
00:06:22,994 --> 00:06:24,314
grant也能查出来了

121
00:06:24,674 --> 00:06:25,714
明白这些吧同学们

122
00:06:25,714 --> 00:06:27,594
这就是左外连接比较简单

123
00:06:28,154 --> 00:06:29,234
好我们来看一下

124
00:06:30,154 --> 00:06:32,514
左外连接左边的表

125
00:06:32,514 --> 00:06:35,474
安普拉E中既没有与department表

126
00:06:35,474 --> 00:06:36,474
当中匹配的行

127
00:06:36,594 --> 00:06:38,954
该查询也会取回安普拉E表

128
00:06:38,954 --> 00:06:39,634
当中的所有行

129
00:06:39,634 --> 00:06:42,194
这个grant就是一个典型的特征

130
00:06:42,194 --> 00:06:42,554
对不对

131
00:06:42,794 --> 00:06:44,674
他就是典型的孤儿数据

132
00:06:44,874 --> 00:06:46,074
好我们来看一个事例

133
00:06:46,314 --> 00:06:48,234
查询所有雇员名字

134
00:06:48,234 --> 00:06:49,514
以及他们的部门名称

135
00:06:49,514 --> 00:06:51,754
包含那些没有部门的雇员

136
00:06:52,234 --> 00:06:54,794
包含那些没有部门的雇员

137
00:06:54,794 --> 00:06:55,914
那么也就是说

138
00:06:55,914 --> 00:06:57,554
雇员表当中没有部门的

139
00:06:57,554 --> 00:06:58,474
也要显示出来

140
00:06:58,594 --> 00:07:00,434
雇员表当中那些

141
00:07:00,434 --> 00:07:01,794
雇员数据也要显示出来

142
00:07:02,074 --> 00:07:02,554
对吧

143
00:07:02,954 --> 00:07:05,074
这个时候我们肯定需要用到外连接了

144
00:07:05,074 --> 00:07:05,554
是吧

145
00:07:05,554 --> 00:07:06,514
用到什么外连接

146
00:07:06,634 --> 00:07:07,834
我们左外就可以搞定

147
00:07:07,834 --> 00:07:10,914
并且把安普拉E作为我的左外连接的

148
00:07:10,914 --> 00:07:12,114
左表不就可以了吗

149
00:07:12,154 --> 00:07:12,634
对不对

150
00:07:12,634 --> 00:07:14,718
好我们来写一个

151
00:07:14,718 --> 00:07:17,818
< No Speech >

152
00:07:17,818 --> 00:07:18,778
然后不通知

153
00:07:18,778 --> 00:07:20,250
< No Speech >

154
00:07:20,250 --> 00:07:20,750
是吧

155
00:07:20,750 --> 00:07:21,250
然后呢

156
00:07:21,250 --> 00:07:23,994
< No Speech >

157
00:07:23,994 --> 00:07:27,194
我们这没有VAL,是吧?查询所有的,直接from就可以了

158
00:07:27,194 --> 00:07:28,698
< No Speech >

159
00:07:28,698 --> 00:07:35,538
from号码给什么呢?我们是不是要用安普拉E去连department并且显示所有的信息

160
00:07:35,538 --> 00:07:38,818
那安普拉E就作为着表,用着外连接不就可以了嘛

161
00:07:38,818 --> 00:07:43,738
那既然是着表了,肯定先写安普拉E啊,对吧?然后E,然后什么?

162
00:07:43,738 --> 00:07:48,254
left join,或者是left alter join

163
00:07:48,254 --> 00:07:57,978
< No Speech >

164
00:07:57,978 --> 00:08:00,778
安卜拉E是不是在我这个关键字的左侧

165
00:08:00,778 --> 00:08:01,778
并且我用的是左表

166
00:08:01,778 --> 00:08:03,738
那它的固人数据肯定会显示出来的

167
00:08:03,738 --> 00:08:05,978
然后用左外连接去连接谁呢

168
00:08:05,978 --> 00:08:08,298
departments这个表

169
00:08:08,298 --> 00:08:09,178
然后D

170
00:08:09,178 --> 00:08:10,298
对吧同学们

171
00:08:10,298 --> 00:08:11,298
然后呢

172
00:08:11,298 --> 00:08:13,538
给定链接条件

173
00:08:13,538 --> 00:08:15,578
注意左外也好右外也好

174
00:08:15,578 --> 00:08:17,658
它也是一个多表的链接查询

175
00:08:17,658 --> 00:08:19,378
我们必须要给定链接条件的

176
00:08:19,378 --> 00:08:22,378
不给链接条件仍然会出现Dcard乘积

177
00:08:22,378 --> 00:08:24,498
那我们怎么给定链接条件呢

178
00:08:24,498 --> 00:08:27,418
仍然是用ON子句来给定链接条件

179
00:08:27,418 --> 00:08:28,698
明白这意思吧

180
00:08:28,698 --> 00:08:30,218
那么什么链接条件呢

181
00:08:30,218 --> 00:08:36,458
那就是一点departmentid等于D.departmentid

182
00:08:37,242 --> 00:08:46,282
明白这意思了吗?上面我们要什么呢?我们要1.lastname,D.departmentname

183
00:08:46,282 --> 00:08:48,670
然后我们执行看一下

184
00:08:48,670 --> 00:08:50,618
< No Speech >

185
00:08:50,618 --> 00:08:52,098
看一下结果集

186
00:08:52,098 --> 00:08:53,114
< No Speech >

187
00:08:53,114 --> 00:08:56,954
看看啊,有没有部门为空的,找一下

188
00:08:56,954 --> 00:08:59,674
< No Speech >

189
00:08:59,674 --> 00:09:00,954
我们看一下啊

190
00:09:00,954 --> 00:09:02,746
< No Speech >

191
00:09:02,746 --> 00:09:06,146
这儿呢,是不是也是grunt啊?它的部门为空

192
00:09:06,146 --> 00:09:08,826
是不是左表的数据,amplie表的数据都查出来了

193
00:09:08,826 --> 00:09:12,106
有人说老师我们后面能不能再加条件了

194
00:09:12,106 --> 00:09:15,786
我除了有链接条件以外,我还想加其他的条件可不可以

195
00:09:15,786 --> 00:09:20,574
当然可以了,val 1.2,比如说amplieid等于

196
00:09:21,178 --> 00:09:23,358
比如说 last name 吧

197
00:09:23,358 --> 00:09:25,818
< No Speech >

198
00:09:25,818 --> 00:09:29,018
LastName等于Fox

199
00:09:29,018 --> 00:09:33,402
< No Speech >

200
00:09:33,402 --> 00:09:41,402
如果你要再加val条件的话,去查fals这个人,其实这跟使不使用外电机就没关系了

201
00:09:41,402 --> 00:09:43,806
这已经很明确的去查什么数据了

202
00:09:44,570 --> 00:09:50,530
对吧 但是我要告诉大家 外连接当中你也可以除了给连接条件以外 你也可以正常给其他的条件的

203
00:09:50,530 --> 00:09:55,490
不是说我用左外连接就不能写vals字句了 不是这样的 vals字句正常可以加

204
00:09:55,490 --> 00:10:01,730
只是说在外连接当中你加vals字句就没有意义了 因为你加vals字句不就找到了 当然有的时候也有意义

205
00:10:01,730 --> 00:10:10,110
比如说我们去查那些 查名字当中 还有记的

206
00:10:10,110 --> 00:10:12,410
< No Speech >

207
00:10:12,410 --> 00:10:14,010
记开头的百分号

208
00:10:14,010 --> 00:10:21,018
< No Speech >

209
00:10:21,018 --> 00:10:23,358
Last name是like

210
00:10:23,358 --> 00:10:28,058
< No Speech >

211
00:10:28,058 --> 00:10:34,458
这样我们能查出很多的数据,但是在这个很多的数据当中是不是也包含了孤儿数据?

212
00:10:34,458 --> 00:10:35,898
< No Speech >

213
00:10:35,898 --> 00:10:41,898
如果用的是等值连接的话,on后面用的不是left,比如说直接用join

214
00:10:41,898 --> 00:10:44,414
那这个grunt肯定是查不出来的

215
00:10:45,370 --> 00:10:47,370
你看吧,这里肯定是没有Ground的

216
00:10:48,154 --> 00:10:54,034
看到了吗同学们,所以说我们要想去查出以记开头的并且他们的这个

217
00:10:54,034 --> 00:10:56,186
< No Speech >

218
00:10:56,186 --> 00:10:59,186
他们的名字是以G开头的

219
00:10:59,186 --> 00:11:01,386
而且还要把如果有固文的话

220
00:11:01,386 --> 00:11:03,026
把安卜拉E的固文也显示出来

221
00:11:03,026 --> 00:11:05,026
那这种仍然得用left outer join

222
00:11:05,026 --> 00:11:07,102
仍然得用外连接

223
00:11:07,898 --> 00:11:09,778
看到了吗同学们,明白这意思吧

224
00:11:09,778 --> 00:11:15,378
所以这里我要告诉大家,外连接当中仍然可以加vals去作为条件的过滤的

225
00:11:15,378 --> 00:11:18,178
好,这是左外,那么我们再来看右外

226
00:11:18,178 --> 00:11:21,378
其实左外我们搞懂了,右外也自然而然就明白了

227
00:11:21,378 --> 00:11:26,338
其实就是把谁,如果用右外连接,把谁作为右表

228
00:11:26,338 --> 00:11:32,418
那么则显示谁的孤儿数据,除了满足条件的数据以外,还显示他的孤儿

229
00:11:32,986 --> 00:11:34,986
这个固然数据明白这意思吧

230
00:11:34,986 --> 00:11:36,986
好那比如说我们现在

231
00:11:36,986 --> 00:11:38,986
看一下这个案例

232
00:11:38,986 --> 00:11:40,894
它是什么呢?

233
00:11:40,894 --> 00:11:42,554
< No Speech >

234
00:11:42,554 --> 00:11:51,314
它是去查这个employee跟department的,但是它的链接条件是write outer join,用的右外链接

235
00:11:51,314 --> 00:11:54,754
然后把department表放到关键字的右侧了

236
00:11:54,754 --> 00:12:03,070
那很显然,department表当中除了会查到那些符合条件的数据,还会显示那些不匹配的数据

237
00:12:03,578 --> 00:12:06,458
是吧同学们 这是这个右外连接

238
00:12:06,458 --> 00:12:16,058
右边的表departments 即使是没有与安波拉意表当中匹配的行

239
00:12:16,058 --> 00:12:20,778
该查询也会取出departments表当中的所有的行 就包括雇员数据

240
00:12:20,778 --> 00:12:23,098
我们来演示一下 实例

241
00:12:23,098 --> 00:12:28,538
查询所有雇员的名字以及他们的部门名称 包含那些没有雇员的部门

242
00:12:28,538 --> 00:12:33,498
注意看需求 没有雇员的部门 也就是说这些部门下面还没有雇员呢

243
00:12:33,498 --> 00:12:40,458
那么就是显示部门当中的除了满足条件的数据以外 还有部门表当中的雇员数据呗

244
00:12:40,458 --> 00:12:45,018
那么这个我们用左外连接也可以 左外连接把部门表放到左侧

245
00:12:45,018 --> 00:12:49,338
然后先写部门表然后left outer join 再去写安波拉意不也可以吗

246
00:12:49,338 --> 00:12:53,498
那么现在我们学的是右外连接 那我就用右外连接来写

247
00:12:53,498 --> 00:12:54,878
怎么写呢

248
00:12:55,642 --> 00:13:02,162
右外连接的话,那还是先from unproperty,然后把left改成rightjoin

249
00:13:02,162 --> 00:13:05,162
这回我把alter去掉,因为我说了alter去掉也是可以的

250
00:13:05,162 --> 00:13:07,842
直接就rightjoin也可以,明白这一次吧

251
00:13:07,842 --> 00:13:13,082
然后departments,注意现在departments这个表是不是在我rightjoin的右侧

252
00:13:13,082 --> 00:13:17,602
那它就是右表,那么它的数据除了会显示正常满足条件的数据以外

253
00:13:17,602 --> 00:13:21,438
它还会显示出孤儿数据,运行看一下

254
00:13:21,438 --> 00:13:23,866
< No Speech >

255
00:13:23,866 --> 00:13:26,906
现在我们看,现在这个Ground肯定是没有了

256
00:13:26,906 --> 00:13:29,758
Ground肯定是没有了

257
00:13:30,490 --> 00:13:38,050
看,现在这些department的内容,在这些部门当中只是有名字,但是没有员工

258
00:13:38,050 --> 00:13:42,654
这不就department表当中的所有的雇人数据也都显示出来了吗?

259
00:13:43,322 --> 00:13:47,002
明白了吗?同学们,这就是右外连接

260
00:13:47,002 --> 00:13:50,242
我们来看一下实时效果反馈

261
00:13:50,242 --> 00:13:52,122
如下说法正确的是

262
00:13:52,122 --> 00:13:56,322
A,左外连接会显示左表中的固而数据

263
00:13:56,322 --> 00:14:00,242
左外连接会显示右表中的固而数据

264
00:14:00,242 --> 00:14:04,602
C,左外连接会显示左右表中的固而数据

265
00:14:04,602 --> 00:14:08,762
D,左外连接不会显示表中的固而数据

266
00:14:08,762 --> 00:14:12,322
那么哪个是正确的?很显然是A嘛

267
00:14:12,322 --> 00:14:16,922
对吧?左外连接肯定会显示左表中的固而数据

268
00:14:16,922 --> 00:14:19,642
所以正确的说法是A

269
00:14:19,642 --> 00:14:21,146
< No Speech >

270
00:14:21,146 --> 00:14:26,746
好,同学们,那么以上我们就讲解了左外连接与右外连接

271
00:14:26,746 --> 00:14:28,346
这个还是比较简单的

272
00:14:28,346 --> 00:14:30,946
好,同学们,那我们这一课就到这

