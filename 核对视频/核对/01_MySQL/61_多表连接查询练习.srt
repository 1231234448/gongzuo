1
00:00:00,000 --> 00:00:01,050
< No Speech >

2
00:00:01,050 --> 00:00:05,850
到目前为止,mySQL的多表查询我们已经讲的差不多了

3
00:00:05,850 --> 00:00:12,570
那么这节课我们再通过一些练习,进一步的去巩固我们对多表查询的一个能力

4
00:00:12,570 --> 00:00:14,170
好,我们先来看第一题

5
00:00:14,170 --> 00:00:17,854
写一个查询,显示所有雇员的

6
00:00:17,854 --> 00:00:18,970
< No Speech >

7
00:00:18,970 --> 00:00:22,270
Department ID 以及 Department Name

8
00:00:22,778 --> 00:00:28,058
那么在这个需求当中我们先分析他要的结果集来源于几张表

9
00:00:28,058 --> 00:00:33,578
我们看,last name跟departmentid很显然来源于employee表

10
00:00:33,578 --> 00:00:39,018
但是department name在employee表里面有吗?肯定是没有的

11
00:00:39,018 --> 00:00:42,538
那么这个字段的值是来源于department表的

12
00:00:42,538 --> 00:00:47,738
所以现在我要想查出这个雇员的部门ID以及部门名称

13
00:00:47,738 --> 00:00:52,858
我必须要做两个表的查询,分别是employee和department

14
00:00:52,858 --> 00:00:56,298
那么这两个表我用什么链接来查询呢?

15
00:00:56,298 --> 00:01:00,858
我们是不是可以用到多表查询当中的等值链接就可以了

16
00:01:00,858 --> 00:01:06,298
为什么要用到等值链接呢?因为employee表当中和department表当中

17
00:01:06,298 --> 00:01:11,418
我们是使用departmentid这一列的数据去做的数据的关联的

18
00:01:11,418 --> 00:01:20,538
也就是说,employee表当中,员工的departmentid如果等于department表当中的departmentid

19
00:01:20,538 --> 00:01:26,462
那就能找到员工的部门的其他的信息,比如说department name

20
00:01:27,162 --> 00:01:32,162
对吧同学们?所以这里我们用一个多表的等值链接查询

21
00:01:32,162 --> 00:01:34,322
就可以查到我们要的数据了

22
00:01:34,322 --> 00:01:35,602
好 我们来写一下

23
00:01:35,602 --> 00:01:36,890
< No Speech >

24
00:01:36,890 --> 00:01:42,930
先写select,然后from,然后where

25
00:01:42,930 --> 00:01:47,930
我们先用cycle92当中的等值链接的方式去写

26
00:01:47,930 --> 00:01:52,330
from employee,然后departmentid

27
00:01:52,330 --> 00:01:55,090
然后接下来要给链接条件的

28
00:01:55,090 --> 00:01:57,490
有多表链接肯定要有链接条件的

29
00:01:57,490 --> 00:02:02,450
1.departmentid等于d.departmentid

30
00:02:02,450 --> 00:02:05,450
我们是通过这个链来做数据关联的

31
00:02:05,450 --> 00:02:09,090
然后他要什么呢

32
00:02:09,090 --> 00:02:13,610
所有雇员的那就没有其他的行的过滤的条件了

33
00:02:13,610 --> 00:02:14,970
然后他要哪些链呢

34
00:02:14,970 --> 00:02:18,930
last name1.last name,还有departmentid

35
00:02:18,930 --> 00:02:21,170
那就1.departmentid

36
00:02:21,170 --> 00:02:23,450
还有什么department name

37
00:02:23,450 --> 00:02:25,450
department name在部门表里

38
00:02:25,450 --> 00:02:28,570
那就d.department name

39
00:02:28,570 --> 00:02:31,130
是不是就可以了,运行

40
00:02:31,130 --> 00:02:33,730
好,我们看到这个结果已经查到了

41
00:02:33,730 --> 00:02:38,650
是吧同学们,这查到了所有雇员以及他们的部门ID

42
00:02:38,650 --> 00:02:40,446
还有他们的部门名称

43
00:02:40,446 --> 00:02:42,042
< No Speech >

44
00:02:42,042 --> 00:02:44,442
好 这是第一题 我们再来看第二题

45
00:02:44,442 --> 00:02:45,530
< No Speech >

46
00:02:45,530 --> 00:02:52,490
第二题他说创建一个部门在80中的所有雇员的工作岗位的唯一列表

47
00:02:52,490 --> 00:02:55,090
在输出中包含部门的地点

48
00:02:55,090 --> 00:02:57,450
那我们先想一下看这个需求

49
00:02:57,450 --> 00:03:02,450
在部门是80的部门是谁啊?部门不就是department ID吗?

50
00:03:02,450 --> 00:03:04,730
也就是说他现在要的这个数据

51
00:03:04,730 --> 00:03:07,290
他的部门ID应该是等于80的

52
00:03:07,290 --> 00:03:10,090
然后所有的工作岗位是谁啊?

53
00:03:10,090 --> 00:03:13,050
工作岗位就是安普莱伊表里的job ID嘛

54
00:03:13,050 --> 00:03:16,730
对不对?然后唯一列表说明这个数据查出来啊

55
00:03:16,730 --> 00:03:17,970
他数据是有重复的

56
00:03:17,970 --> 00:03:21,250
我们得把它重复的去掉才能保证它是一个唯一的列表

57
00:03:21,250 --> 00:03:26,050
对不对?然后呢在输出中包含部门的地点

58
00:03:26,050 --> 00:03:30,290
那么部门的地点是什么?部门的地点就是location ID啊

59
00:03:30,290 --> 00:03:33,610
那么在department的表里是有location ID的

60
00:03:33,610 --> 00:03:35,530
是不是?所以对于这个查询呢

61
00:03:35,530 --> 00:03:38,090
他所涉及到的表仍然是两张表

62
00:03:38,090 --> 00:03:41,810
分别是安普莱伊跟department对吧?

63
00:03:41,810 --> 00:03:44,250
好,我们去写一个这个查询啊

64
00:03:44,250 --> 00:03:47,330
还是用这个SQL92当中的这个

65
00:03:47,330 --> 00:03:50,610
SQL92当中的这个等值连接就可以了

66
00:03:50,610 --> 00:03:53,530
是不是?内连接的等值连接就可以了

67
00:03:53,530 --> 00:03:54,878
这么简单吗? 在项目标题,取写角色硬体叶 intro向割推连接

68
00:03:55,514 --> 00:03:58,782
然后 from 然后 where

69
00:03:58,782 --> 00:04:01,370
< No Speech >

70
00:04:01,370 --> 00:04:07,294
那么先去定义哪个表呢?

71
00:04:07,294 --> 00:04:08,346
< No Speech >

72
00:04:08,346 --> 00:04:15,266
对吧?然后veryrl 链接条件1.departmentid等于d.departmentid

73
00:04:15,266 --> 00:04:18,306
然后注意and这两家条件了

74
00:04:18,306 --> 00:04:23,066
因为它有行的过滤嘛行的选择什么呢?部门id是80的

75
00:04:23,066 --> 00:04:26,546
那就是1.departmentid等于80

76
00:04:26,546 --> 00:04:31,266
那么其实对于这个条件你也可以用employee的departmentid

77
00:04:31,266 --> 00:04:34,186
也可以用department表里的departmentid

78
00:04:34,186 --> 00:04:35,946
就是d.departmentid也可以

79
00:04:35,946 --> 00:04:39,026
为什么?因为这两个例子的值反馈都是相等的

80
00:04:39,026 --> 00:04:40,734
肯定是一样的 明白这意思吧?

81
00:04:40,734 --> 00:04:42,874
< No Speech >

82
00:04:42,874 --> 00:04:47,474
显示什么列呢?显示部门的JobID是吧

83
00:04:47,474 --> 00:04:50,434
一点JobID还有这个LocationID

84
00:04:50,434 --> 00:04:52,434
LocationID是在部门表里的

85
00:04:52,434 --> 00:04:55,594
那就是D.LocationID不就可以了吗?是吧

86
00:04:55,594 --> 00:04:56,954
然后我们运行看一下

87
00:04:56,954 --> 00:04:58,994
看现在查到了这么多数据

88
00:04:58,994 --> 00:05:00,714
而且这些数据都是有重复的

89
00:05:00,714 --> 00:05:03,474
然后他说了是返回唯一的工作列表

90
00:05:03,474 --> 00:05:06,474
那我是不是得加一个Distinct关键字去除重复啊

91
00:05:06,474 --> 00:05:07,294
是吧运行

92
00:05:08,122 --> 00:05:11,322
现在就变成两条数据了 重复的已经剔除掉了

93
00:05:11,322 --> 00:05:13,722
< No Speech >

94
00:05:13,722 --> 00:05:25,726
好 这是第二题 我们再来看第三题 它说写一个查询显示所有有佣金的雇员的last name,department name,location id和signature

95
00:05:25,726 --> 00:05:26,746
< No Speech >

96
00:05:26,746 --> 00:05:32,062
我们还是先来分析,在这个查询当中会涉及到哪几个表

97
00:05:32,062 --> 00:05:35,130
< No Speech >

98
00:05:35,130 --> 00:05:41,090
department name,department表,location id,department表里也有

99
00:05:41,090 --> 00:05:44,050
然后城市,城市不就是city吗?

100
00:05:44,050 --> 00:05:47,690
city在department表里可没有,部门表里没有城市

101
00:05:47,690 --> 00:05:50,410
那在哪个表里呢?在location表里

102
00:05:50,410 --> 00:05:51,902
我们看一下这个表结构

103
00:05:51,902 --> 00:05:54,970
< No Speech >

104
00:05:54,970 --> 00:05:58,450
在department的表里是不是有一个location id

105
00:05:58,450 --> 00:05:59,130
看到了吗

106
00:05:59,130 --> 00:06:01,690
然后location id它是一个外界

107
00:06:02,490 --> 00:06:06,770
locationid参照于location表的locationid

108
00:06:06,770 --> 00:06:13,330
也就是说部门跟location他们采用的是locationid来做的数据

109
00:06:13,330 --> 00:06:15,090
用的这一个列做的数据关联

110
00:06:15,090 --> 00:06:16,450
我们看location是

111
00:06:16,450 --> 00:06:17,626
< No Speech >

112
00:06:17,626 --> 00:06:18,966
都量

113
00:06:19,482 --> 00:06:20,842
这里是不是有个location id

114
00:06:20,842 --> 00:06:21,882
而且它是主件

115
00:06:21,882 --> 00:06:22,842
明白这一次吧

116
00:06:22,842 --> 00:06:25,602
所以我们在用department链接location的时候

117
00:06:25,602 --> 00:06:28,042
是不是就可以用location id来作为链接条件了

118
00:06:28,042 --> 00:06:28,442
对吧

119
00:06:28,442 --> 00:06:29,602
OK

120
00:06:29,602 --> 00:06:30,042
好

121
00:06:30,042 --> 00:06:31,362
那么现在我们已经确定了

122
00:06:31,362 --> 00:06:33,802
它要做三个表的一个链接查询了

123
00:06:33,802 --> 00:06:34,122
是吧

124
00:06:34,122 --> 00:06:34,402
好

125
00:06:34,402 --> 00:06:35,802
我们来写一个这样的操作

126
00:06:35,802 --> 00:06:38,802
那么其实我们在写多表查询操作时

127
00:06:38,802 --> 00:06:40,562
如果你已经分析出来了

128
00:06:40,562 --> 00:06:41,962
数据来源于几个表

129
00:06:41,962 --> 00:06:43,162
那么其实这个查询

130
00:06:43,162 --> 00:06:45,242
你已经完成50%了

131
00:06:45,242 --> 00:06:47,602
剩下那50%就是给条件了

132
00:06:47,602 --> 00:06:49,042
做列的选择了

133
00:06:49,042 --> 00:06:50,522
然后做一些其他工作了

134
00:06:50,522 --> 00:06:51,282
明白这一次吧

135
00:06:51,282 --> 00:06:51,802
好

136
00:06:51,802 --> 00:06:54,906
< No Speech >

137
00:06:54,906 --> 00:07:00,746
我们仍然用92当中的内联的等值连接就可以了

138
00:07:00,746 --> 00:07:02,526
然后不变

139
00:07:02,526 --> 00:07:03,770
< No Speech >

140
00:07:03,770 --> 00:07:06,850
安普拉E E这是一个对吧

141
00:07:06,850 --> 00:07:08,650
然后的part

142
00:07:09,306 --> 00:07:14,346
ment d 这是一个,location l 这是一个

143
00:07:14,346 --> 00:07:17,266
然后接下来我们就要给链接条件了

144
00:07:17,266 --> 00:07:18,786
那么这里同学们注意啊

145
00:07:18,786 --> 00:07:20,346
我们未来在工作当中啊

146
00:07:20,346 --> 00:07:23,466
我们所写的这个多表链接的表的数量

147
00:07:23,466 --> 00:07:24,986
可不仅仅是三个

148
00:07:24,986 --> 00:07:28,186
有的时候可能是四个五个六个甚至更多

149
00:07:28,186 --> 00:07:30,346
那么如果你链接的表的数量

150
00:07:30,346 --> 00:07:32,706
所涉及到这个表的数量特别多

151
00:07:32,706 --> 00:07:35,546
你在给定链接条件的时候一定要细心

152
00:07:35,546 --> 00:07:37,826
如果你少给一个链接条件

153
00:07:37,826 --> 00:07:39,626
就会出现笛卡尔乘积啊

154
00:07:39,626 --> 00:07:40,746
对吧我们说了

155
00:07:40,746 --> 00:07:43,066
n表链接时在做n表链接时

156
00:07:43,066 --> 00:07:44,586
它的链接条件必须是

157
00:07:44,586 --> 00:07:46,346
至少是n-1个链接条件

158
00:07:46,346 --> 00:07:46,906
对吧

159
00:07:46,906 --> 00:07:50,706
那么我们怎么才能保证这个不遗漏链接条件呢

160
00:07:50,706 --> 00:07:52,186
哎我给你个小窍门啊

161
00:07:52,186 --> 00:07:53,626
起码我一直是这么做的

162
00:07:53,626 --> 00:07:54,506
怎么办呢

163
00:07:54,506 --> 00:07:57,466
从左到右一个一个的去连

164
00:07:57,466 --> 00:08:00,306
比如说安普拉伊先连department

165
00:08:00,306 --> 00:08:02,986
那在vr里就先写他俩的链接条件

166
00:08:02,986 --> 00:08:04,946
当他俩链接条件写完以后

167
00:08:04,946 --> 00:08:08,266
再去考虑department跟location的链接条件

168
00:08:08,266 --> 00:08:10,906
然后再把他俩的链接条件给定

169
00:08:10,906 --> 00:08:11,946
然后他俩给定以后

170
00:08:11,946 --> 00:08:13,626
比如说location后面还有表

171
00:08:13,626 --> 00:08:15,946
那再考虑location跟这个表的链接条件

172
00:08:15,946 --> 00:08:16,706
再把它给定

173
00:08:16,706 --> 00:08:17,546
以此类推

174
00:08:17,546 --> 00:08:20,226
一步一步的去做两个表的条件的链接

175
00:08:20,226 --> 00:08:21,226
一步一步的去做

176
00:08:21,226 --> 00:08:23,226
这样你就不会出现遗漏的现象了

177
00:08:23,226 --> 00:08:24,226
明白这意思吧

178
00:08:24,226 --> 00:08:24,746
好

179
00:08:24,746 --> 00:08:26,146
那么拿这个案例来说

180
00:08:26,146 --> 00:08:27,586
我现在是不是应该先考虑

181
00:08:27,586 --> 00:08:29,866
安普拉伊跟department的链接啊

182
00:08:29,866 --> 00:08:30,266
对不对

183
00:08:30,266 --> 00:08:31,106
链接条件

184
00:08:31,106 --> 00:08:33,982
那就是一点department等于

185
00:08:33,982 --> 00:08:39,834
< No Speech >

186
00:08:39,834 --> 00:08:40,434
对吧

187
00:08:40,434 --> 00:08:41,278
然后按的

188
00:08:41,278 --> 00:08:43,034
< No Speech >

189
00:08:43,034 --> 00:08:45,434
这个链接条件是完成它俩链接的

190
00:08:45,434 --> 00:08:47,434
你还要考虑它俩链接呢

191
00:08:47,434 --> 00:08:49,634
那就是D.location

192
00:08:49,634 --> 00:08:54,634
department的表跟locations不用的locationid来做的表的链接

193
00:08:54,634 --> 00:08:57,954
这一列是这个列里放的是关联链接数据

194
00:08:57,954 --> 00:09:00,606
locationid等于L点

195
00:09:00,606 --> 00:09:02,618
< No Speech >

196
00:09:02,618 --> 00:09:07,178
这样我们就完成了三个表的链接 你看我这里有两个链接条件

197
00:09:07,178 --> 00:09:09,898
三个表这不就是n-1个链接条件嘛

198
00:09:09,898 --> 00:09:16,698
那么链接条件搞定以后 接下来我们再看它有没有其他的条件

199
00:09:16,698 --> 00:09:17,278
才有啊

200
00:09:17,278 --> 00:09:18,618
< No Speech >

201
00:09:18,618 --> 00:09:23,918
显示所有有佣金的股员,有佣金,这是一个行的选择

202
00:09:23,918 --> 00:09:25,502
后面还得加按钮

203
00:09:25,502 --> 00:09:26,874
< No Speech >

204
00:09:26,874 --> 00:09:29,374
有雍金,雍金怎么判断是不是有呢?

205
00:09:29,374 --> 00:09:30,490
< No Speech >

206
00:09:30,490 --> 00:09:33,690
commission pct去做is not a non判断就可以了

207
00:09:33,690 --> 00:09:36,210
如果符合这个条件的不都是有用金的嘛

208
00:09:36,210 --> 00:09:36,690
对不对

209
00:09:36,690 --> 00:09:37,890
哎那就是一点

210
00:09:37,890 --> 00:09:40,862
commission pct is not a non

211
00:09:41,754 --> 00:09:43,954
对吧?这是做行的选择的条件

212
00:09:43,954 --> 00:09:46,554
然后他要什么呢?要last name

213
00:09:46,554 --> 00:09:48,474
d.lastname

214
00:09:48,474 --> 00:09:49,874
还有department name

215
00:09:49,874 --> 00:09:52,474
那就d.department name

216
00:09:52,474 --> 00:09:53,594
还有location id

217
00:09:53,594 --> 00:09:55,914
location id在部门表里也有

218
00:09:55,914 --> 00:09:57,194
location表里也有

219
00:09:57,194 --> 00:09:58,154
你用哪个都行

220
00:09:58,154 --> 00:10:02,274
那就d.location id

221
00:10:02,274 --> 00:10:03,234
然后还有城市

222
00:10:03,234 --> 00:10:04,874
城市在location表里的

223
00:10:04,874 --> 00:10:06,238
l.city

224
00:10:06,238 --> 00:10:09,466
< No Speech >

225
00:10:09,466 --> 00:10:17,598
这样就查到了所有有佣金的雇员的last name,department name,以及location id,还有城市

226
00:10:17,598 --> 00:10:19,258
< No Speech >

227
00:10:19,258 --> 00:10:20,894
好,我们把笔迹整理一下

228
00:10:20,894 --> 00:10:22,906
< No Speech >

229
00:10:22,906 --> 00:10:24,190
好 这是第三题

230
00:10:24,190 --> 00:10:25,658
< No Speech >

231
00:10:25,658 --> 00:10:33,098
显示所有在其lastname当中有小写a的雇员的lastname跟department name

232
00:10:33,098 --> 00:10:37,378
这个题就简单了是不是?这个题肯定来源于两个表了

233
00:10:37,378 --> 00:10:42,658
employee跟department的表,因为department name不在部门表里

234
00:10:42,658 --> 00:10:47,498
然后它的过滤的条件是lastname当中还有小写a

235
00:10:47,498 --> 00:10:50,814
like就可以了,like%a%不就行了

236
00:10:50,814 --> 00:10:55,674
< No Speech >

237
00:10:55,674 --> 00:10:57,674
把这个去掉

238
00:10:57,674 --> 00:10:59,674
select它,然后from

239
00:10:59,674 --> 00:11:01,786
< No Speech >

240
00:11:01,786 --> 00:11:14,666
然后e,然后department d,然后where,一点department id等于d点department id,然后where,然后and,还有什么条件呢?

241
00:11:15,514 --> 00:11:16,766
最后一名。

242
00:11:16,766 --> 00:11:19,002
< No Speech >

243
00:11:19,002 --> 00:11:24,962
名当中还有a,那就把A的百分号做一个名字,做一个a的通配嘛

244
00:11:24,962 --> 00:11:27,966
然后他要什么呢?要last name一点

245
00:11:27,966 --> 00:11:32,058
< No Speech >

246
00:11:32,058 --> 00:11:34,058
这样不就可以了吗 是吧 运行

247
00:11:34,058 --> 00:11:35,742
这些数据呢

248
00:11:35,742 --> 00:11:37,274
< No Speech >

249
00:11:37,274 --> 00:11:44,382
这些数据都是名字当中含有A的 并且他们的名字以及部门名称也都查出来了

250
00:11:44,382 --> 00:11:47,322
< No Speech >

251
00:11:47,322 --> 00:11:50,802
好,这是第四题,我们再来看第五题

252
00:11:50,802 --> 00:11:51,898
< No Speech >

253
00:11:51,898 --> 00:11:59,038
第五题它说用一个内连接 这个内连接指的就是cycle99当中的内连接

254
00:11:59,038 --> 00:12:02,298
< No Speech >

255
00:12:02,298 --> 00:12:13,298
写一个查询,显示那些工作在多伦多的所有的雇员的last name, job, department number

256
00:12:13,298 --> 00:12:16,830
department number指的是department id和department name

257
00:12:17,338 --> 00:12:21,054
那么大家想一下,在这个查询当中会涉及到几个表呢?

258
00:12:21,882 --> 00:12:28,282
是不是仍然会涉及到三个表?为什么?你看,last name,job,job指的是job id

259
00:12:28,282 --> 00:12:35,442
是不是在安波拉伊表当中?department number,当然department id在安波拉伊表里也有

260
00:12:35,442 --> 00:12:40,642
然后department name肯定是在department的表当中了,对不对?

261
00:12:40,642 --> 00:12:46,402
然后还要查询条件是工作在多伦多的多伦多是一个城市

262
00:12:46,402 --> 00:12:49,406
城市在哪个表里?是不是在location的表里?

263
00:12:50,138 --> 00:12:53,498
对吧?我得用location的c体来作为查询条件

264
00:12:53,498 --> 00:12:56,658
所以这里肯定会涉及到三个表的一个链接的

265
00:12:56,658 --> 00:13:01,498
是不是?然后这已经要求了用cycle99的内链接去写

266
00:13:01,498 --> 00:13:03,838
好 那我们就用一个cycle99的内链接去写

267
00:13:03,838 --> 00:13:08,378
< No Speech >

268
00:13:08,378 --> 00:13:09,726
谷歌

269
00:13:09,726 --> 00:13:10,970
< No Speech >

270
00:13:10,970 --> 00:13:17,970
先用employee,e起个笔名,然后inner,join或者join,inner也可以不写

271
00:13:17,970 --> 00:13:20,810
然后练谁呢?练department,d

272
00:13:20,810 --> 00:13:24,970
然后后面紧跟的是要给ons句来定义连接条件的

273
00:13:24,970 --> 00:13:28,158
对不对?定义employee跟department的连接条件

274
00:13:28,158 --> 00:13:29,370
< No Speech >

275
00:13:29,370 --> 00:13:32,958
然后一点departmentid等于d点

276
00:13:32,958 --> 00:13:34,362
< No Speech >

277
00:13:34,362 --> 00:13:36,082
这就完成了两个表的连接

278
00:13:36,082 --> 00:13:38,202
那我们还要去连接Location呢

279
00:13:38,202 --> 00:13:39,326
那就继续在

280
00:13:39,326 --> 00:13:40,890
< No Speech >

281
00:13:40,890 --> 00:13:42,890
locations l

282
00:13:42,890 --> 00:13:44,450
然后再来一个on

283
00:13:44,450 --> 00:13:48,690
用on词句再去定义departments跟locations的链接条件

284
00:13:48,690 --> 00:13:49,170
对吧

285
00:13:49,170 --> 00:13:52,766
那就是d.locationid等于l.locationid

286
00:13:52,766 --> 00:13:55,162
< No Speech >

287
00:13:55,162 --> 00:14:05,246
明白了吗?那么我们现在这个表链接好以后,它后面是不是还有条件呢?什么条件?行的过滤的条件呢?显示那些工作在多伦多的嘛

288
00:14:06,138 --> 00:14:10,846
那就VL子去加条件不就可以了吗?去加行的过滤不就可以了吗?

289
00:14:10,846 --> 00:14:19,290
< No Speech >

290
00:14:19,290 --> 00:14:21,086
NTO 多伦多

291
00:14:21,086 --> 00:14:22,938
< No Speech >

292
00:14:22,938 --> 00:14:25,178
然后他要什么呢 我们看一下

293
00:14:25,978 --> 00:14:29,378
这个雇员的last name,那就一点last name

294
00:14:29,378 --> 00:14:33,018
还有雇员的job id,一点job id

295
00:14:33,018 --> 00:14:35,742
还有这个雇员的department的id

296
00:14:36,666 --> 00:14:39,426
还有department的id 还有department的name

297
00:14:39,426 --> 00:14:39,934
那就是

298
00:14:39,934 --> 00:14:42,426
< No Speech >

299
00:14:42,426 --> 00:14:43,966
部门表的名称是吧

300
00:14:43,966 --> 00:14:45,690
< No Speech >

301
00:14:45,690 --> 00:14:54,046
这样我们就查到了在多伦多这个城市工作的员工的JobID、部门ID以及部门名称

302
00:14:54,046 --> 00:14:56,698
< No Speech >

303
00:14:56,698 --> 00:14:58,526
好 这是这个第五题

304
00:14:58,526 --> 00:15:01,338
< No Speech >

305
00:15:01,338 --> 00:15:05,498
第六题要求显示固原的last name

306
00:15:05,498 --> 00:15:07,034
< No Speech >

307
00:15:07,034 --> 00:15:11,550
和安普拉伊number连同他们的经理的last name。

308
00:15:11,550 --> 00:15:13,754
< No Speech >

309
00:15:13,754 --> 00:15:20,074
那我们看到这个题以后马上就想到了应该用到一个什么链接方式去查询呢

310
00:15:20,074 --> 00:15:22,074
是不是一个自连接呀 对吧

311
00:15:22,074 --> 00:15:25,834
因为经理和雇员都在安排仪表当中

312
00:15:25,834 --> 00:15:29,434
那肯定需要用到一个自连接的方式去查询了 对不对

313
00:15:29,434 --> 00:15:33,374
那现在这个需求是查询雇员以及联动他们经理的

314
00:15:33,374 --> 00:15:34,842
< No Speech >

315
00:15:34,842 --> 00:15:38,398
那么对于这样一个查询我们怎么去做呢

316
00:15:38,398 --> 00:15:41,882
< No Speech >

317
00:15:41,882 --> 00:15:45,362
那么这我们已经分析出来了,肯定要用一个自连接

318
00:15:45,362 --> 00:15:50,962
这个自连接我就用SQL99的inner join的这种

319
00:15:50,962 --> 00:15:53,950
在inner join当中用自连接的方式去实现一个产生

320
00:15:54,522 --> 00:16:00,922
因为这种SQL 9.2的这种自联机我们已经做了已经练过了比较简单是不是

321
00:16:01,722 --> 00:16:05,406
基于cycle99的inner-join方式的自连接

322
00:16:05,406 --> 00:16:08,762
< No Speech >

323
00:16:08,762 --> 00:16:11,762
那么我们先来写select,然后from

324
00:16:11,762 --> 00:16:15,282
那么这里我是不是就要做两个表的连接

325
00:16:15,282 --> 00:16:17,842
哪两个表?这两个表是不是都是安普拉意啊?

326
00:16:17,842 --> 00:16:19,602
对不对?好,那就是

327
00:16:19,602 --> 00:16:22,586
< No Speech >

328
00:16:22,586 --> 00:16:27,706
然后这个表别名我叫W,表示这个worker

329
00:16:27,706 --> 00:16:32,466
然后join或者是inner join是不是都可以

330
00:16:32,466 --> 00:16:36,826
比如说inner join吧,inner join谁呢?还是连接他自己

331
00:16:36,826 --> 00:16:42,386
然后这个表我叫M,那么这个表我打算当成经理表来看待

332
00:16:42,386 --> 00:16:46,826
然后紧跟着给on连接条件,那么这个连接条件是什么呢?

333
00:16:46,826 --> 00:16:50,910
我是不是应该用W的managerID去等于

334
00:16:50,910 --> 00:16:52,122
< No Speech >

335
00:16:52,122 --> 00:16:53,602
安普洛伊ID

336
00:16:53,602 --> 00:16:56,670
这样不就查到了员工以及联通他们的经理了

337
00:16:57,338 --> 00:16:58,558
是吧同学们

338
00:16:59,450 --> 00:17:06,090
他们这个列要什么呢?要员工的雇员的last name,那就是w的last name

339
00:17:06,090 --> 00:17:08,350
起别名 high tech,技术,后期也是高是你的时间成就,其实我想在该市场在写拆 해서 laptop 我安排了七个台铺在职计结合团队员来聚集,不好意思我现在事有急躁 But I don't know how to make the last name, except that

340
00:17:08,350 --> 00:17:10,042
< No Speech >

341
00:17:10,042 --> 00:17:11,422
我们看一下EMP

342
00:17:11,422 --> 00:17:13,178
< No Speech >

343
00:17:13,178 --> 00:17:19,038
然后还要w的这个就是固原的安普拉EID 这个别名我们叫emp

344
00:17:19,038 --> 00:17:20,378
< No Speech >

345
00:17:20,378 --> 00:17:21,018
可以吧

346
00:17:21,018 --> 00:17:22,878
然后还有经理的内容

347
00:17:22,878 --> 00:17:23,898
< No Speech >

348
00:17:23,898 --> 00:17:25,378
M不是经理表吗

349
00:17:25,378 --> 00:17:27,354
< No Speech >

350
00:17:27,354 --> 00:17:29,470
那么这个别名我们叫MGR

351
00:17:30,266 --> 00:17:31,838
然后还要经理的

352
00:17:32,826 --> 00:17:35,166
是吧 经理的ID 那就是m.x.x.x

353
00:17:35,166 --> 00:17:36,922
< No Speech >

354
00:17:36,922 --> 00:17:38,686
然后这个别名我们叫

355
00:17:38,686 --> 00:17:39,738
< No Speech >

356
00:17:39,738 --> 00:17:40,958
GRID吧

357
00:17:40,958 --> 00:17:42,010
< No Speech >

358
00:17:42,010 --> 00:17:44,638
这样我们就把投影的列已经搞定了

359
00:17:44,638 --> 00:17:47,802
< No Speech >

360
00:17:47,802 --> 00:17:49,278
这样就查到了

361
00:17:49,278 --> 00:17:52,570
< No Speech >

362
00:17:52,570 --> 00:17:55,966
雇员ID以及连同他们经理的经理名以及经理代

363
00:17:55,966 --> 00:17:59,226
< No Speech >

364
00:17:59,226 --> 00:18:01,346
好 我们把它粘到笔记当中

365
00:18:01,346 --> 00:18:01,598
啊

366
00:18:02,266 --> 00:18:09,066
这样我们就通过6个练习去对MySQL当中的多表连接做了一个进一步的练习

367
00:18:09,066 --> 00:18:12,986
目的就是让同学们能够更扎实的去掌握多表连接

368
00:18:12,986 --> 00:18:18,266
因为我们平时在查询时,我们更多的还是要去完成多表的查询的

369
00:18:18,266 --> 00:18:22,866
因为我们未来查询的数据在很多种情况下都是来源于多个表的

370
00:18:22,866 --> 00:18:24,026
明白这些吧?

371
00:18:24,026 --> 00:18:26,238
好同学们,那我们这节课就到这

