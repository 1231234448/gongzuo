1
00:00:00,538 --> 00:00:02,018
Hello 小伙伴大家好

2
00:00:02,018 --> 00:00:05,858
这节课我们来学习一个叫做CAP的定理

3
00:00:05,858 --> 00:00:08,538
可能看到这几个词小伙伴心里就纳闷了

4
00:00:08,538 --> 00:00:10,178
我为什么要学习这个CAP定理

5
00:00:10,178 --> 00:00:12,138
我们在上一节课了解到

6
00:00:12,138 --> 00:00:13,138
我们从现在开始

7
00:00:13,138 --> 00:00:18,698
我们要从我们之前的单机架构演变成我们的分布式架构

8
00:00:18,698 --> 00:00:20,578
既然说我们变成分布式的了

9
00:00:20,578 --> 00:00:22,858
每一个服务都是各司其职

10
00:00:22,858 --> 00:00:23,418
是不是

11
00:00:23,418 --> 00:00:26,258
但是我们还要保证服务和服务之间的什么

12
00:00:26,258 --> 00:00:27,978
数据的一致性

13
00:00:27,978 --> 00:00:31,218
比如说我们有好多好多人在提供服务

14
00:00:31,218 --> 00:00:34,538
但是你的比如说在经理餐馆的话

15
00:00:34,538 --> 00:00:36,338
你这么多服务都在提供服务的话

16
00:00:36,338 --> 00:00:38,898
是不是菜的价格是不得是一致的

17
00:00:38,898 --> 00:00:41,578
每个人比如说你还有个客人突然看到一个人来说

18
00:00:41,578 --> 00:00:42,858
这个公报计定多少钱

19
00:00:42,858 --> 00:00:45,538
你们是不是可以保证每个人说的话是不是都是一致的

20
00:00:45,538 --> 00:00:46,858
这个时候我们到底该怎么去做

21
00:00:46,858 --> 00:00:51,338
这就是我们在分布式架构里边要注意的CAP的定理

22
00:00:51,338 --> 00:00:52,258
我们来具体看一下

23
00:00:52,258 --> 00:00:54,698
首先分布式架构

24
00:00:54,698 --> 00:00:57,338
分布式系统变得非常的重要了

25
00:00:57,338 --> 00:01:01,698
现在基本上所有的大型网站都是分布式架构了

26
00:01:01,698 --> 00:01:03,738
就是我们之前所说过的什么抖音

27
00:01:03,738 --> 00:01:04,018
是吧

28
00:01:04,018 --> 00:01:05,298
京东

29
00:01:05,298 --> 00:01:06,618
淘宝

30
00:01:06,618 --> 00:01:08,258
网易等等

31
00:01:08,258 --> 00:01:10,818
它都是这种分布式架构的

32
00:01:10,818 --> 00:01:12,098
既然说你是分布式

33
00:01:12,098 --> 00:01:14,898
你就逃不了CAP的定理

34
00:01:14,898 --> 00:01:16,218
到底什么是CAP呢

35
00:01:16,218 --> 00:01:17,258
我们来看一下

36
00:01:17,258 --> 00:01:22,738
在这个分布式系统里边最大的难点就是各个节点状态如何同步

37
00:01:22,738 --> 00:01:26,178
以及CAP定理这方面是一个基本的定理

38
00:01:26,178 --> 00:01:27,538
什么意思呢

39
00:01:27,538 --> 00:01:30,578
我们应该既然说你好多人在经营一个餐馆

40
00:01:30,578 --> 00:01:33,898
你是得保证这个服务他到底今天上班了没有

41
00:01:33,898 --> 00:01:35,378
洗菜的那个人今天来了没有

42
00:01:35,378 --> 00:01:37,378
或者是我一会让他去端个盘子

43
00:01:37,378 --> 00:01:38,698
他到底在不在

44
00:01:38,698 --> 00:01:40,298
一会得让会计结个账

45
00:01:40,298 --> 00:01:41,738
那会计到底在不在

46
00:01:41,738 --> 00:01:44,018
是得保证所有的人

47
00:01:44,018 --> 00:01:45,738
一是状态你得同步

48
00:01:45,738 --> 00:01:46,858
他到底在不在线

49
00:01:46,858 --> 00:01:47,658
是不是

50
00:01:47,658 --> 00:01:48,058
二

51
00:01:48,058 --> 00:01:50,978
你是不是得保证所有人的数据是不是得是一致的

52
00:01:50,978 --> 00:01:52,418
那个人他说给人家公报

53
00:01:52,418 --> 00:01:53,338
今天说的10块钱

54
00:01:53,338 --> 00:01:54,298
我去的时候我不知道

55
00:01:54,298 --> 00:01:55,178
我的是旧数据

56
00:01:55,178 --> 00:01:57,178
我的是20块钱是不是会出现问题

57
00:01:57,178 --> 00:01:59,298
是不是还要保证数据的还一致性

58
00:01:59,298 --> 00:02:01,898
那我们来看一下在分布式架构里边

59
00:02:01,898 --> 00:02:05,618
最难搞定的这个CAP定理到底是何方神仙

60
00:02:05,618 --> 00:02:06,778
我们来看一下

61
00:02:06,778 --> 00:02:07,538
第一个啊

62
00:02:07,538 --> 00:02:10,378
这个分布式系统里边的三个指标啊

63
00:02:10,378 --> 00:02:11,418
最重要的三个指标

64
00:02:11,418 --> 00:02:12,058
你只要记住

65
00:02:12,058 --> 00:02:13,618
只要是分布式系统

66
00:02:13,618 --> 00:02:14,818
他就这三个指标

67
00:02:14,818 --> 00:02:17,058
第一个一致性

68
00:02:17,058 --> 00:02:20,818
你得保证一致性是不是每个服务每个服务

69
00:02:20,818 --> 00:02:22,858
所有的数据得保证到一致性

70
00:02:22,858 --> 00:02:23,378
第二个呢

71
00:02:23,378 --> 00:02:24,538
是可用性

72
00:02:24,538 --> 00:02:25,978
什么意思呢

73
00:02:25,978 --> 00:02:28,938
就是你得保证每一个人他到底是活着呢

74
00:02:28,938 --> 00:02:29,498
还是没活着

75
00:02:29,498 --> 00:02:30,938
你说今天来上班了还是没来上班

76
00:02:30,938 --> 00:02:32,258
你得知道是吧

77
00:02:32,258 --> 00:02:32,938
第三个呢

78
00:02:32,938 --> 00:02:34,778
是分区容错性

79
00:02:34,778 --> 00:02:37,858
这就是这个分布式系统的三个指标

80
00:02:37,858 --> 00:02:38,338
当然了

81
00:02:38,338 --> 00:02:44,898
他的英语的前面这个单词就是CAP一致性可用性分区容错性

82
00:02:44,898 --> 00:02:47,298
就是分布式系统的三个指标

83
00:02:47,298 --> 00:02:48,698
那这个指标能干嘛呢

84
00:02:48,698 --> 00:02:49,538
我们来看一下吧

85
00:02:49,538 --> 00:02:50,258
第一个啊

86
00:02:50,258 --> 00:02:52,858
分区的容错性什么意思呢

87
00:02:52,858 --> 00:02:54,738
既然既然说我们是一个分布式系统了

88
00:02:54,738 --> 00:02:56,698
把一个大系统拆成了好多好多个系统

89
00:02:56,698 --> 00:02:58,658
那就说在分布式系统里边

90
00:02:58,658 --> 00:03:01,098
那就说它是有好多好多个子网络

91
00:03:01,098 --> 00:03:02,218
是有好多好多人吧

92
00:03:02,218 --> 00:03:04,858
那每个子网络我们给他称它为是一个区

93
00:03:04,858 --> 00:03:07,098
那分区容错是什么意思呢

94
00:03:07,098 --> 00:03:08,178
就我们就说啊

95
00:03:08,178 --> 00:03:09,818
这个服务和服务之间

96
00:03:09,818 --> 00:03:11,698
比如说你看我们这有个V0服务

97
00:03:11,698 --> 00:03:12,578
你这边有个叫什么

98
00:03:12,578 --> 00:03:13,938
这边有个叫G1服务

99
00:03:13,938 --> 00:03:15,338
这边有个G2服务

100
00:03:15,338 --> 00:03:16,138
那这两个服务呢

101
00:03:16,138 --> 00:03:17,938
是各自的一个子系统

102
00:03:17,938 --> 00:03:19,378
我们要保证这两个服务

103
00:03:19,378 --> 00:03:21,178
他们之间的通讯

104
00:03:21,178 --> 00:03:23,858
为什么要通讯你作为厨师

105
00:03:23,858 --> 00:03:25,738
你是不是要通知那个服务员

106
00:03:25,738 --> 00:03:26,658
给人家端盘子

107
00:03:26,658 --> 00:03:27,178
对不对

108
00:03:27,178 --> 00:03:29,258
所以说你要保证你们俩可以聊天

109
00:03:29,258 --> 00:03:30,578
你们俩可以说话呀

110
00:03:30,578 --> 00:03:31,258
但是呢

111
00:03:31,258 --> 00:03:33,018
在分布式架构里边

112
00:03:33,018 --> 00:03:34,618
既然说你是计算机的话

113
00:03:34,618 --> 00:03:35,298
通讯啊

114
00:03:35,298 --> 00:03:36,258
我们说啊

115
00:03:36,258 --> 00:03:38,098
通讯有可能会失败

116
00:03:38,098 --> 00:03:38,738
记住啊

117
00:03:38,738 --> 00:03:40,378
通讯有可能会失败

118
00:03:40,378 --> 00:03:42,258
就是你突然找不到那个服务员了

119
00:03:42,258 --> 00:03:42,658
是吧

120
00:03:42,658 --> 00:03:44,178
你不可能百分之百就找到服务员

121
00:03:44,178 --> 00:03:45,258
比如人家上厕所了

122
00:03:45,258 --> 00:03:46,298
你不也找不到人家

123
00:03:46,298 --> 00:03:48,778
那在计算机里边是有可能会通讯失败

124
00:03:48,778 --> 00:03:49,138
是吧

125
00:03:49,138 --> 00:03:50,298
比如说一个服务在国内

126
00:03:50,298 --> 00:03:51,338
一个服务在美国

127
00:03:51,338 --> 00:03:52,338
这就是两个区嘛

128
00:03:52,338 --> 00:03:53,618
他们之间就没办法通讯了

129
00:03:53,618 --> 00:03:54,138
所以说呢

130
00:03:54,138 --> 00:03:56,618
在CAP定理里边记住啊

131
00:03:56,618 --> 00:03:58,458
在CAP定理里边

132
00:03:58,458 --> 00:04:00,138
P就是我们这个说的什么

133
00:04:00,138 --> 00:04:01,738
分区的容错性

134
00:04:01,738 --> 00:04:02,698
这种问题啊

135
00:04:02,698 --> 00:04:04,298
是永远都会存在的

136
00:04:04,298 --> 00:04:06,058
我们要时刻保证

137
00:04:06,058 --> 00:04:07,338
我就找不到那个服务员了

138
00:04:07,338 --> 00:04:08,338
就是这个问题啊

139
00:04:08,338 --> 00:04:09,698
可能会永久都存在

140
00:04:09,698 --> 00:04:10,698
我们避免不了

141
00:04:10,698 --> 00:04:11,338
明白没有

142
00:04:11,338 --> 00:04:13,458
我们避免不了这种分区容错性

143
00:04:13,458 --> 00:04:14,538
这种出现

144
00:04:14,538 --> 00:04:15,138
所以说呢

145
00:04:15,138 --> 00:04:16,418
在CAP定理里边

146
00:04:16,418 --> 00:04:18,938
这个P它是永久都会存在的

147
00:04:18,938 --> 00:04:19,618
所以说呢

148
00:04:19,618 --> 00:04:21,138
CAP定理告诉我们

149
00:04:21,138 --> 00:04:23,498
剩下的C和A无法做到

150
00:04:23,498 --> 00:04:24,378
什么意思呢

151
00:04:24,378 --> 00:04:25,858
在CAP定理里边

152
00:04:25,858 --> 00:04:26,698
我们知道了

153
00:04:26,698 --> 00:04:28,898
C这个问题肯定会出现

154
00:04:28,898 --> 00:04:29,618
明白没有

155
00:04:29,618 --> 00:04:32,158
那我们来看看C和A到底是什么吧

156
00:04:32,986 --> 00:04:34,986
第二个是一致性

157
00:04:34,986 --> 00:04:37,626
这个一致性我们要保证的其实就是

158
00:04:37,626 --> 00:04:42,386
每一个人给客户报的菜的价格得是一致的

159
00:04:42,386 --> 00:04:44,226
那什么时候会出现不一致呢

160
00:04:44,226 --> 00:04:45,066
我们来打个比方

161
00:04:45,066 --> 00:04:47,226
比如说我们有两个服务

162
00:04:47,226 --> 00:04:49,226
一个是G1一个是G2

163
00:04:49,226 --> 00:04:49,906
明白没有

164
00:04:49,906 --> 00:04:52,466
然后我们要进行一个写的操作

165
00:04:52,466 --> 00:04:53,466
比如说我要进行一个写的

166
00:04:53,466 --> 00:04:55,106
我要改一个菜品的价格

167
00:04:55,106 --> 00:04:56,906
这个时候我们来举一个例子

168
00:04:56,906 --> 00:05:00,066
比如说我们客户端给服务端是吧

169
00:05:00,066 --> 00:05:01,546
老板给服务员说了

170
00:05:01,546 --> 00:05:04,266
这个菜你看我们说它的价格是多少

171
00:05:04,266 --> 00:05:04,986
是V1

172
00:05:04,986 --> 00:05:08,706
就是他只告诉了这个叫做G1的服务员

173
00:05:08,706 --> 00:05:09,306
明白没有

174
00:05:09,306 --> 00:05:10,946
就他做了一个写的操作

175
00:05:10,946 --> 00:05:14,666
将我们这个G1里边的V0改成了V1

176
00:05:14,666 --> 00:05:15,806
来看这

177
00:05:16,506 --> 00:05:18,506
V0改成了V1

178
00:05:18,506 --> 00:05:21,986
但是G2这边V0还是V0

179
00:05:21,986 --> 00:05:23,986
这两个数据是不是不一致的

180
00:05:23,986 --> 00:05:25,986
你给G1说了没给G2说

181
00:05:25,986 --> 00:05:27,986
这就叫数据的不一致了

182
00:05:27,986 --> 00:05:30,986
那如果说有个人他问的是这个服务员

183
00:05:30,986 --> 00:05:32,986
那代表什么呢

184
00:05:32,986 --> 00:05:34,986
这个服务员的价格肯定就是旧的价格了

185
00:05:34,986 --> 00:05:36,986
就是保证不了一致性

186
00:05:36,986 --> 00:05:39,986
那什么时候我们会保证一致性呢

187
00:05:39,986 --> 00:05:41,986
我们来具体再看啊

188
00:05:41,986 --> 00:05:43,986
那我想让他保证一致性

189
00:05:43,986 --> 00:05:45,986
那这个时候该怎么去做

190
00:05:45,986 --> 00:05:47,986
我的这个客户端

191
00:05:47,986 --> 00:05:49,986
我这个老板嘛

192
00:05:49,986 --> 00:05:51,986
给这个服务员说这个价格他变了

193
00:05:51,986 --> 00:05:53,986
然后怎么办呢

194
00:05:53,986 --> 00:05:55,986
然后这个服务员他通知了这个服务员

195
00:05:55,986 --> 00:05:57,986
那这个时候呢他们从V1

196
00:05:57,986 --> 00:05:59,986
这边也变成V1

197
00:05:59,986 --> 00:06:01,986
那这个时候就保证了数据的一致性

198
00:06:01,986 --> 00:06:03,986
明白没有

199
00:06:03,986 --> 00:06:05,986
这就叫数据的一致性

200
00:06:05,986 --> 00:06:07,986
那我们继续来看啊

201
00:06:07,986 --> 00:06:09,986
那什么是可用性

202
00:06:09,986 --> 00:06:11,986
什么意思呢

203
00:06:11,986 --> 00:06:13,986
就是只要收到用户的请求

204
00:06:13,986 --> 00:06:15,986
服务器就必须给出回应

205
00:06:15,986 --> 00:06:17,986
什么意思呢

206
00:06:17,986 --> 00:06:19,986
就是老板只要给这个服务员说话

207
00:06:19,986 --> 00:06:21,986
这个服务员就会给出一个响应

208
00:06:21,986 --> 00:06:23,986
就是我问你啊

209
00:06:23,986 --> 00:06:25,986
菜多少钱呀你就得告诉我

210
00:06:25,986 --> 00:06:27,986
你不告诉我说明你有问题

211
00:06:27,986 --> 00:06:29,986
但是呢这种可能性为什么会出现

212
00:06:29,986 --> 00:06:31,986
为什么会出现

213
00:06:31,986 --> 00:06:33,986
我们来试一下

214
00:06:33,986 --> 00:06:35,986
比如说

215
00:06:35,986 --> 00:06:37,086
用户啊他问

216
00:06:37,946 --> 00:06:40,186
这个菜多少钱啊 它说V1价格

217
00:06:40,186 --> 00:06:41,626
然后他又问这个G2啊

218
00:06:41,626 --> 00:06:44,026
然后这个菜多少钱啊 它又说V1这个价格

219
00:06:44,026 --> 00:06:45,546
你看服务器都给出回应了

220
00:06:45,546 --> 00:06:48,386
我问你你就给我 这就叫可用性 明白没有

221
00:06:48,386 --> 00:06:50,866
那如果说我说张三你不在

222
00:06:50,866 --> 00:06:52,546
张三这个菜多少钱 张三不在

223
00:06:52,546 --> 00:06:54,306
张三不见 张三可能上厕所了

224
00:06:54,306 --> 00:06:56,946
那这代表什么 张三这个服务它不能用

225
00:06:56,946 --> 00:06:59,026
那如果说我说张三这个钱多少钱

226
00:06:59,026 --> 00:07:00,426
这个菜多少钱 张三告诉我了

227
00:07:00,426 --> 00:07:02,466
这代表张三那个服务它是可用的

228
00:07:02,466 --> 00:07:05,306
这就是可用性嘛 你到底在还是不在

229
00:07:05,306 --> 00:07:07,466
这个服务它到底能用还是不能用

230
00:07:07,466 --> 00:07:09,226
这就叫可用性 OK

231
00:07:09,226 --> 00:07:13,026
所以说呢这个一致性和可用性是矛盾的

232
00:07:13,026 --> 00:07:14,826
有的人纳闷 老师

233
00:07:14,826 --> 00:07:18,786
这个一致性和可用性它为什么就矛盾了呢

234
00:07:18,786 --> 00:07:20,306
我们来解释一下

235
00:07:20,306 --> 00:07:22,546
比如说我们这个客户端

236
00:07:22,546 --> 00:07:25,226
我们要想要保证这个一致性

237
00:07:25,226 --> 00:07:27,066
又想要保证可用性

238
00:07:27,066 --> 00:07:30,266
那我们要准确的做法是怎么去做的

239
00:07:30,266 --> 00:07:31,746
那比如说你看

240
00:07:31,746 --> 00:07:34,226
这个客户端它要给这个G1说

241
00:07:34,226 --> 00:07:36,866
它这个之前是G0是吧 V0

242
00:07:36,866 --> 00:07:40,666
然后呢我说你要把这个菜改成V1的价格

243
00:07:40,666 --> 00:07:41,706
没问题吧

244
00:07:41,706 --> 00:07:43,266
那我们要保证一致性

245
00:07:43,266 --> 00:07:44,026
这个时候怎么办

246
00:07:44,026 --> 00:07:46,026
假如说有个服务员问他了呢

247
00:07:46,026 --> 00:07:46,826
是不是问他了

248
00:07:46,826 --> 00:07:48,706
那他就告的是错误的价格

249
00:07:48,706 --> 00:07:49,546
那怎么办呢

250
00:07:49,546 --> 00:07:51,746
就是当我们这个人

251
00:07:51,746 --> 00:07:55,266
当我们这个人他说这个价格改了的时候

252
00:07:55,266 --> 00:07:58,586
那他呢就告诉这个人说这个价格你锁住

253
00:07:58,586 --> 00:07:59,226
什么意思呢

254
00:07:59,226 --> 00:08:01,626
就是你就是我还没有给你改的时候

255
00:08:01,626 --> 00:08:02,906
你这个价格你就给他锁住

256
00:08:02,906 --> 00:08:04,706
就任何人不能访问这个价格

257
00:08:04,706 --> 00:08:05,626
你不能告诉我这个价格

258
00:08:05,626 --> 00:08:06,906
这个价格我还不知道呢

259
00:08:06,906 --> 00:08:08,946
这个价格呢我们领导说了要改

260
00:08:08,946 --> 00:08:10,146
但是呢具体是多少价格

261
00:08:10,146 --> 00:08:11,026
我还不知道

262
00:08:11,026 --> 00:08:11,666
明白没有

263
00:08:11,666 --> 00:08:12,986
就是你问我要东西

264
00:08:12,986 --> 00:08:14,306
我还不给你

265
00:08:14,306 --> 00:08:16,186
你看这就矛盾了呀

266
00:08:16,186 --> 00:08:17,466
按道理来说呢

267
00:08:17,466 --> 00:08:19,866
这个可用性是不是就是我只要问你要数据

268
00:08:19,866 --> 00:08:20,706
你就得给我

269
00:08:20,706 --> 00:08:22,706
但是呢这个时候会出现个什么问题

270
00:08:22,706 --> 00:08:26,706
我要保证一致性的时候就是我呀给他说价格了

271
00:08:26,706 --> 00:08:28,746
他呢给他改价格是不是

272
00:08:28,746 --> 00:08:29,786
但是他改价格的时候

273
00:08:29,786 --> 00:08:31,866
是不是得把这个价格先锁住吧

274
00:08:31,866 --> 00:08:33,346
让别人不能先问是不是

275
00:08:33,346 --> 00:08:35,106
所以说你锁住了

276
00:08:35,106 --> 00:08:38,506
我问大家张三这个这个菜多少钱呀

277
00:08:38,506 --> 00:08:41,746
他说老师这个这个这个这个菜呀

278
00:08:41,746 --> 00:08:44,626
我们领导说了这个菜他要他要改价格

279
00:08:44,626 --> 00:08:45,506
具体多少价格呢

280
00:08:45,506 --> 00:08:46,226
我也不知道

281
00:08:46,226 --> 00:08:46,866
那这个时候呢

282
00:08:46,866 --> 00:08:48,666
我问大家服务还可用吗

283
00:08:48,666 --> 00:08:49,146
所以说呢

284
00:08:49,146 --> 00:08:51,306
如果说我们要保证一致性这个服务

285
00:08:51,306 --> 00:08:52,066
他是不可能

286
00:08:52,066 --> 00:08:53,386
因为你没告诉人家多少价格吗

287
00:08:53,386 --> 00:08:56,146
是不是那你说当我们把数据同步过来之后

288
00:08:56,146 --> 00:08:57,426
这边也变成什么呢

289
00:08:57,426 --> 00:08:58,706
也变成V1了

290
00:08:58,706 --> 00:09:00,306
那也变成这个V1之后呢

291
00:09:00,306 --> 00:09:02,026
这个时候就符合了

292
00:09:02,026 --> 00:09:05,146
你看如果说我们要保证一致性

293
00:09:05,146 --> 00:09:08,866
必然这个G2就会失去可用性

294
00:09:08,866 --> 00:09:09,546
明白没有

295
00:09:09,546 --> 00:09:12,626
那如果说我们要保证了这种可用性了

296
00:09:12,626 --> 00:09:13,346
什么意思

297
00:09:13,346 --> 00:09:14,626
如果说我们保证了可用性

298
00:09:14,626 --> 00:09:16,266
也就是这个G2他能用啊

299
00:09:16,266 --> 00:09:17,026
就是我问他要价格

300
00:09:17,026 --> 00:09:17,666
他就告诉我了

301
00:09:17,666 --> 00:09:19,586
但是有可能是旧的价格

302
00:09:19,586 --> 00:09:22,506
这就是保证可用性就会失去一致性

303
00:09:22,506 --> 00:09:24,986
保证了一致性就会失去可用性

304
00:09:24,986 --> 00:09:25,546
所以说呢

305
00:09:25,546 --> 00:09:27,706
这两者他们是有矛盾的啊

306
00:09:27,706 --> 00:09:28,546
明白没有

307
00:09:28,546 --> 00:09:28,986
但是呢

308
00:09:28,986 --> 00:09:30,066
你说老师那我明白了

309
00:09:30,066 --> 00:09:31,426
这个分布式架构

310
00:09:31,426 --> 00:09:33,826
分布式这个架构里边

311
00:09:33,826 --> 00:09:35,706
这个分区容错性

312
00:09:35,706 --> 00:09:37,106
他是永远都会成立

313
00:09:37,106 --> 00:09:37,706
是不是

314
00:09:37,706 --> 00:09:39,586
因为他有可能会通讯失败吗

315
00:09:39,586 --> 00:09:39,826
呃

316
00:09:39,826 --> 00:09:42,346
在这个一致性和可用性上边呢

317
00:09:42,346 --> 00:09:43,786
我们要做一个抉择

318
00:09:43,786 --> 00:09:47,386
到底是你是你要开发一套分布式架构啊

319
00:09:47,386 --> 00:09:48,986
分布式架构的一套系统

320
00:09:48,986 --> 00:09:51,106
你是偏向于一致性

321
00:09:51,106 --> 00:09:53,186
还是偏向于可用性呢

322
00:09:53,186 --> 00:09:53,506
所以说呢

323
00:09:53,506 --> 00:09:55,826
我们来看一下两者之间的一个区别吧

324
00:09:55,826 --> 00:09:56,186
呃

325
00:09:56,186 --> 00:09:58,706
如果说第一个就是说一致性和可用性

326
00:09:58,706 --> 00:09:59,706
我们该如何选择

327
00:09:59,706 --> 00:10:00,426
什么意思呢

328
00:10:00,426 --> 00:10:04,066
就是你要选择的是cp还是ap

329
00:10:04,066 --> 00:10:07,226
就你要选择的是一致性还是可用性

330
00:10:07,226 --> 00:10:08,786
这就需要大家去抉择了

331
00:10:08,786 --> 00:10:12,026
就你要开发一套分布式架构的一套项目

332
00:10:12,026 --> 00:10:15,146
你是偏向于cp还是偏向于ap

333
00:10:15,146 --> 00:10:16,586
你是偏向于一致性

334
00:10:16,586 --> 00:10:18,626
还是偏向于可用性

335
00:10:18,626 --> 00:10:19,306
那那老师

336
00:10:19,306 --> 00:10:20,106
我不会选择

337
00:10:20,106 --> 00:10:22,626
那我告诉大家什么叫一致性

338
00:10:23,546 --> 00:10:25,386
如果说你在开发的那个项目呢

339
00:10:25,386 --> 00:10:27,186
你是牵扯到比较重要的数据

340
00:10:27,186 --> 00:10:28,426
比如说金钱

341
00:10:28,426 --> 00:10:28,946
是吧

342
00:10:28,946 --> 00:10:31,066
商品的数量商品的价格

343
00:10:31,066 --> 00:10:32,866
那如果说你没有保证了一致性

344
00:10:32,866 --> 00:10:34,226
那那完蛋了是吧

345
00:10:34,226 --> 00:10:35,426
你在街上促销的时候

346
00:10:35,426 --> 00:10:37,026
好多人买的价格都是不一致的

347
00:10:37,026 --> 00:10:38,306
是不是这就完犊子了

348
00:10:38,306 --> 00:10:39,146
你肯定被开除了

349
00:10:39,146 --> 00:10:40,186
所以说这个时候啊

350
00:10:40,186 --> 00:10:42,226
你肯定要偏向于一致性

351
00:10:42,226 --> 00:10:45,306
那如果说你是要做一些网页的更新

352
00:10:45,306 --> 00:10:47,546
就是让大家只是看到一些页面

353
00:10:47,546 --> 00:10:48,226
有的漂亮

354
00:10:48,226 --> 00:10:49,266
有的不漂亮

355
00:10:49,266 --> 00:10:49,546
然后呢

356
00:10:49,546 --> 00:10:50,986
有的客户看到的是老页面

357
00:10:50,986 --> 00:10:52,866
有的客户看到的是旧页面

358
00:10:52,866 --> 00:10:54,426
或者是新页面是吧

359
00:10:54,426 --> 00:10:56,746
这个你看到旧页面或者看到新页面呢

360
00:10:56,746 --> 00:10:57,786
问题不大

361
00:10:57,786 --> 00:10:59,146
因为价格都是一致的

362
00:10:59,146 --> 00:11:00,626
只是页面的美观程度

363
00:11:00,626 --> 00:11:01,066
所以说呢

364
00:11:01,066 --> 00:11:03,666
你要保证的是用户他都能看到页面

365
00:11:03,666 --> 00:11:06,466
而不保证这个用户他的一致性

366
00:11:06,466 --> 00:11:07,066
明白没有

367
00:11:07,066 --> 00:11:08,786
他没有牵涉到一些重要的数据

368
00:11:08,786 --> 00:11:11,026
这个时候你的这个分布式架构呢

369
00:11:11,026 --> 00:11:13,586
你就要偏向于可用性

370
00:11:13,586 --> 00:11:15,746
就你要从这块开始靠拢了

371
00:11:15,746 --> 00:11:16,386
明白没有

372
00:11:16,386 --> 00:11:17,066
所以说呢

373
00:11:17,066 --> 00:11:17,906
简而言之啊

374
00:11:17,906 --> 00:11:19,466
到底是cp还是ap呢

375
00:11:19,466 --> 00:11:20,786
完全取决于你的业务

376
00:11:20,786 --> 00:11:22,306
如果是这种金钱啊

377
00:11:22,306 --> 00:11:23,106
商品价格啊

378
00:11:23,106 --> 00:11:25,586
这种数量这种比较敏感的数据

379
00:11:25,586 --> 00:11:26,346
那你就要干嘛呢

380
00:11:26,346 --> 00:11:27,746
要有偏向于一致性啊

381
00:11:27,746 --> 00:11:28,946
如果说你是不重要的

382
00:11:28,946 --> 00:11:30,666
那你就偏向于可用性好了

383
00:11:30,666 --> 00:11:31,226
那这节课呢

384
00:11:31,226 --> 00:11:34,346
给大家介绍一下这个cap的这个定理

385
00:11:34,346 --> 00:11:35,866
还是比较好玩的是吧

386
00:11:35,866 --> 00:11:36,266
其实呢

387
00:11:36,266 --> 00:11:38,146
小伙伴只要记住就是一致性

388
00:11:38,146 --> 00:11:40,146
可用性分区容错性就明白了

389
00:11:40,146 --> 00:11:44,026
这也是比较重要的一个分布式系统的三个指标

390
00:11:44,026 --> 00:11:44,506
所以说呢

391
00:11:44,506 --> 00:11:45,146
这个概念呢

392
00:11:45,146 --> 00:11:46,306
我们必须要说啊

393
00:11:46,306 --> 00:11:46,826
小伙伴呢

394
00:11:46,826 --> 00:11:48,706
也就是必须要听得懂

395
00:11:48,706 --> 00:11:49,466
如果没听懂

396
00:11:49,466 --> 00:11:51,346
我们再听一遍好了

397
00:11:51,346 --> 00:11:51,786
这节课呢

398
00:11:51,786 --> 00:11:53,186
我们讲解这个cp啊

399
00:11:53,186 --> 00:11:54,226
到这就结束了

400
00:11:54,226 --> 00:11:54,986
结束之前呢

401
00:11:54,986 --> 00:11:56,266
我们再做个练习

402
00:11:56,266 --> 00:11:57,586
针对于重要数据

403
00:11:57,586 --> 00:11:59,226
我们该如何选择cp定理

404
00:11:59,226 --> 00:12:01,546
我们是要偏向于一致性是吧

405
00:12:01,546 --> 00:12:03,986
还是可用性还是分区容错性呢

406
00:12:03,986 --> 00:12:06,026
重要数据必须要选择一致性

407
00:12:06,026 --> 00:12:06,426
所以说呢

408
00:12:06,426 --> 00:12:07,026
这道题啊

409
00:12:07,026 --> 00:12:09,026
我们应该选择的是b好了

410
00:12:09,026 --> 00:12:09,506
这节课呢

411
00:12:09,506 --> 00:12:10,946
我们讲解cp啊

412
00:12:10,946 --> 00:12:12,506
到这就结束了

413
00:12:12,506 --> 00:12:13,534
谢谢大家

