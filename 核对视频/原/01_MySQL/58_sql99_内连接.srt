1
00:00:00,000 --> 00:00:01,306
< No Speech >

2
00:00:01,306 --> 00:00:07,226
这节课我们再来讲解一下SQL99当中的内连接,Inner Join

3
00:00:07,226 --> 00:00:12,586
那么我们之前已经讲解过了SQL92当中的内连接了

4
00:00:12,586 --> 00:00:17,866
在SQL92的内连接当中分为等值连接、非等值连接以及自连接

5
00:00:17,866 --> 00:00:24,506
那么SQL99当中的内连接同样也是可以实现等值连接、非等值连接以及自连接的

6
00:00:24,506 --> 00:00:28,382
只是他们语句的编写形式上不同

7
00:00:29,274 --> 00:00:33,022
在SQL99中需要用到inner join以及on的方式

8
00:00:34,010 --> 00:00:37,210
明白这一次吧?好,我们来看一下这个图,inner join

9
00:00:37,210 --> 00:00:42,590
所以内连接我们可以用它去做类似于等值连接这样的查询

10
00:00:42,590 --> 00:00:46,330
< No Speech >

11
00:00:46,330 --> 00:00:53,770
InnerJoin去链接AB两个表,并且给的条件是两个表某个列数值相等的

12
00:00:53,770 --> 00:00:57,374
那么这个时候他查询到的就是两个表当中数值相等的

13
00:00:57,374 --> 00:00:58,618
< No Speech >

14
00:00:58,618 --> 00:01:03,098
明白这一次吧?好,这是inner join。我们来看一下语法

15
00:01:03,098 --> 00:01:13,502
select查询列名,from表名,from表意就是别名,注意select from,然后后面跟的是inner join。

16
00:01:14,106 --> 00:01:19,306
注意啊,这就没有val条件了,直接就是inner join,然后链接表的表名

17
00:01:19,306 --> 00:01:23,546
然后注意这个inner是可以省掉的,只写join也可以的,明白这意思吧

18
00:01:23,546 --> 00:01:27,146
然后on来给定链接条件,这是它的语法

19
00:01:27,146 --> 00:01:29,246
OK,我们再来看一下,看这个

20
00:01:29,246 --> 00:01:33,690
< No Speech >

21
00:01:33,690 --> 00:01:37,930
还有一个join,然后on,看到了吗?是不是没有val条件呢?

22
00:01:37,930 --> 00:01:44,490
那么from后面有一个emplye表,然后innerjoin或者是把inner去掉

23
00:01:44,490 --> 00:01:47,610
我说了,inner是可以省略不写的,直接写join也可以

24
00:01:47,610 --> 00:01:50,090
但是join你不能去掉,join去掉的话

25
00:01:50,090 --> 00:01:53,450
你这块就得用val关键字来做这个条件的判断了

26
00:01:53,450 --> 00:01:57,490
而我们现在用的是on字句,所以这块就不能去掉join了

27
00:01:57,490 --> 00:01:59,678
join,然后department的d

28
00:01:59,678 --> 00:02:00,954
< No Speech >

29
00:02:00,954 --> 00:02:05,194
注意看R后面给的是连接条件 这不就是一个等值连接嘛

30
00:02:05,194 --> 00:02:11,034
那如果我把等号换成大于号或者小于号或者不等号呢?

31
00:02:11,034 --> 00:02:13,470
那就是一个非等值连接啊!

32
00:02:14,010 --> 00:02:17,650
是吧同学们?所以说到底是等值的还是非等值的

33
00:02:17,650 --> 00:02:20,810
不是在于你用的是inner join还是用的其他的

34
00:02:20,810 --> 00:02:23,210
关键看你链接的条件用的符号是什么

35
00:02:23,210 --> 00:02:26,810
对不对?那如果我from后面给的是employee

36
00:02:26,810 --> 00:02:28,382
join又连接了employee

37
00:02:28,986 --> 00:02:30,906
InnerJoin又连接了Amplye

38
00:02:30,906 --> 00:02:31,466
那这是什么

39
00:02:31,466 --> 00:02:32,734
这不就是表的自连接吗

40
00:02:32,734 --> 00:02:34,298
< No Speech >

41
00:02:34,298 --> 00:02:40,298
所以我们用SQL99的inner join也可以实现等值连接、非等值连接以及自连接

42
00:02:40,298 --> 00:02:42,298
明白这些了吧?

43
00:02:42,298 --> 00:02:47,298
那么这个时候就可以去查询departmentid相同的数据了

44
00:02:47,298 --> 00:02:49,886
这是用inner join加on

45
00:02:49,886 --> 00:02:53,786
< No Speech >

46
00:02:53,786 --> 00:02:56,266
用ons去指定更多的链接条件

47
00:02:56,266 --> 00:02:56,946
什么意思呢

48
00:02:56,946 --> 00:02:58,786
我们刚刚是两个表链接

49
00:02:58,786 --> 00:03:00,706
现在比如说我要连三个表

50
00:03:00,706 --> 00:03:01,586
那该怎么做呢

51
00:03:01,586 --> 00:03:03,710
注意啊连三个表它的语法是这样的

52
00:03:04,250 --> 00:03:05,470
由后面的跟随者

53
00:03:05,470 --> 00:03:07,226
< No Speech >

54
00:03:07,226 --> 00:03:11,946
然后用join关键字或者inner join关键字去连接第二个表

55
00:03:11,946 --> 00:03:14,826
然后后面紧跟的是on,注意啊

56
00:03:14,826 --> 00:03:20,746
inner join或者join后面肯定跟的是none,因为你要给连接条件

57
00:03:20,746 --> 00:03:26,426
没有这个on的话,那么它就会出现笛卡尔乘积了

58
00:03:26,426 --> 00:03:29,694
所以join然后他然后on

59
00:03:30,266 --> 00:03:36,506
Department的departmentid等于一点departmentid去做这两个表的一个链接条件

60
00:03:36,506 --> 00:03:37,066
对吧

61
00:03:37,066 --> 00:03:38,186
现在你连了两个表

62
00:03:38,186 --> 00:03:39,786
如果你还想连第三个表

63
00:03:39,786 --> 00:03:46,946
那继续在这个on的后面再加join或者inner join去连接下一个表location

64
00:03:46,946 --> 00:03:48,746
然后再给定链接条件

65
00:03:48,746 --> 00:03:49,226
什么呢

66
00:03:49,226 --> 00:03:51,226
你用department去连location

67
00:03:51,226 --> 00:03:52,746
那么它的链接条件是什么

68
00:03:52,746 --> 00:03:57,666
onD.locationid等于L.locationid

69
00:03:57,666 --> 00:03:58,266
明白吧

70
00:03:58,266 --> 00:04:00,506
如果你要想还有继续连接新的表

71
00:04:00,506 --> 00:04:02,106
在后面再加join

72
00:04:02,106 --> 00:04:03,226
然后你的表名

73
00:04:03,226 --> 00:04:08,226
然后on拿location的哪个链跟这个表的哪个链去连接给定链接条件

74
00:04:08,826 --> 00:04:19,706
CodeU在执行的时候,会从左侧向右侧,或者由上至下,逐步解析链接关系

75
00:04:19,706 --> 00:04:22,650
< No Speech >

76
00:04:22,650 --> 00:04:26,730
那么这是inner join比较简单 我们来看一下实例

77
00:04:26,730 --> 00:04:33,050
查询雇员的名字为fox的雇员ID 薪水与部门名称

78
00:04:33,050 --> 00:04:39,930
你看他要雇员ID 安波拉依ID 薪水salary部门名称department name

79
00:04:39,930 --> 00:04:44,810
那很显然这个数据是来源于两个表的 那我们是不是得做一个多表查询呢

80
00:04:44,810 --> 00:04:48,170
多表查询 查询这个雇员的部门名称

81
00:04:48,170 --> 00:04:54,730
那是不是得用安波拉依的department ID 去链接department表的department ID

82
00:04:54,730 --> 00:05:01,050
对吧同学们 连完以后如果我们有新的条件 除了链接条件以外

83
00:05:01,050 --> 00:05:06,090
如果我们有新的链接条件 如果有新的对数据过滤的条件 对行使选择的条件

84
00:05:06,090 --> 00:05:09,290
那我们就要加vail关键字了 明白吧

85
00:05:09,290 --> 00:05:13,530
inner join是指定表 on指的是链接条件 我再强调一遍

86
00:05:13,530 --> 00:05:17,210
on后面跟着必定是两个表的链接条件

87
00:05:17,210 --> 00:05:23,930
如果我们有除了表的链接条件以外的其他的条件 仍然要用vail子句的

88
00:05:24,506 --> 00:05:25,786
明白这些吧同学们

89
00:05:25,786 --> 00:05:27,550
我们来写一个这个

90
00:05:27,550 --> 00:05:32,698
< No Speech >

91
00:05:32,698 --> 00:05:36,738
他现在要查的表是两个是吧 我们先把表定义出来

92
00:05:36,738 --> 00:05:39,618
select from, and applye

93
00:05:39,618 --> 00:05:41,618
e就是一个表吧

94
00:05:41,618 --> 00:05:44,338
然后我们现在是不是要用内连接

95
00:05:44,338 --> 00:05:47,038
是吧 那就用innerJoy

96
00:05:47,546 --> 00:05:49,986
或者是怎么的 直接写join是不是也没问题

97
00:05:49,986 --> 00:05:52,186
那我先写全 inner join

98
00:05:52,186 --> 00:05:54,346
然后用它去连哪个表呢

99
00:05:54,346 --> 00:05:57,226
inner join后面跟的是你连的那个表的表名

100
00:05:57,226 --> 00:06:00,466
我连的是department表 对吧

101
00:06:00,466 --> 00:06:02,506
但是现在还没有给链接条件

102
00:06:02,506 --> 00:06:04,426
我们通过谁来给定链接条件

103
00:06:04,426 --> 00:06:06,706
通过on子句来给定链接条件

104
00:06:06,706 --> 00:06:09,226
on你用的是等值来连它们呢

105
00:06:09,226 --> 00:06:11,026
用的是非等值来连接呢

106
00:06:11,026 --> 00:06:12,666
是要on来给定的 对吧

107
00:06:12,666 --> 00:06:15,746
那么很显然我们这个需求在inner内连接当中

108
00:06:15,746 --> 00:06:17,946
是要用它的等值链接来解决这个问题的

109
00:06:17,946 --> 00:06:23,466
那就是一点department id等于d.department id

110
00:06:24,058 --> 00:06:28,538
同学们 这不还是等于那一链接当中包含了等值和非等值吗

111
00:06:28,538 --> 00:06:32,898
到底是等值还是非等值 取决于你链接条件给的是相等还是不等 是吧

112
00:06:32,898 --> 00:06:35,418
是相等还是其他吗 对吧

113
00:06:35,418 --> 00:06:39,538
好 然后链接条件给定了

114
00:06:39,538 --> 00:06:43,618
接下来如果你还有除了链接条件以外的其他的条件

115
00:06:43,618 --> 00:06:46,138
那么就要用well子句来做数据的过滤了

116
00:06:46,138 --> 00:06:47,258
行了过滤了 是吧

117
00:06:47,258 --> 00:06:51,018
比如说现在它的条件是固原的名字必须得是fox

118
00:06:51,018 --> 00:06:54,538
那就是一点lastname等于

119
00:06:54,538 --> 00:06:56,762
< No Speech >

120
00:06:56,762 --> 00:07:02,842
然后他要什么呢?要雇员的名字、雇员的ID、薪水与部门名称

121
00:07:02,842 --> 00:07:09,822
雇员的名字、雇员的ID、薪水与部门名称

122
00:07:10,394 --> 00:07:17,114
employeeid,薪水,e.salary,d.department name

123
00:07:17,114 --> 00:07:25,674
看到了吗,现在查到了Fox的员工ID,薪水,e.salary

124
00:07:25,674 --> 00:07:30,398
如果我们把in去掉,只留join

125
00:07:31,162 --> 00:07:36,122
是不是也没有问题啊?所以在内联当中,inner关键字是可以省略的

126
00:07:36,122 --> 00:07:40,082
明白这意思吧?好,这就是内连接的使用,非常的简单

127
00:07:40,082 --> 00:07:45,642
其实就是相比较我们SQL 9.2的版本当中

128
00:07:45,642 --> 00:07:52,002
它的书写格式变了,加了一个inner join或者是join,加了一个on

129
00:07:52,002 --> 00:07:55,582
看到了吗?inner join on或者join,就是多加了这两个

130
00:07:56,250 --> 00:08:03,450
明白这意思吧?所以说呢相比我们SQL-92的这个等值或者非等值都是没什么太大的区别的

131
00:08:03,450 --> 00:08:07,230
就多了两个关键字而已

132
00:08:07,230 --> 00:08:08,602
< No Speech >

133
00:08:08,602 --> 00:08:10,842
好,我们来看一下实时效果反馈

134
00:08:10,842 --> 00:08:16,482
在内链接中,使用什么来指定链接的表?用什么来指定链接条件?

135
00:08:16,482 --> 00:08:23,282
A. inner join,然后 on,用inner join来指定链接的表,用on来指定链接条件

136
00:08:23,282 --> 00:08:27,922
B. between,用between来指定链接的表,用on来指定链接条件

137
00:08:27,922 --> 00:08:33,362
C. inner join来指定链接的表,用in来指定链接条件

138
00:08:33,362 --> 00:08:38,802
D. between来指定链接的表,用and来指定链接的条件

139
00:08:38,802 --> 00:08:41,842
那么在这四个选项当中,哪个是对的呢?

140
00:08:41,842 --> 00:08:51,082
大家想一想,很显然正确的是A,用inner join来指定链接表,用on来指定链接条件

141
00:08:51,082 --> 00:08:53,842
它们是成对出现的

142
00:08:53,842 --> 00:08:58,922
明白这一次吧?只要有inner join,必定有on,因为on是来给定表的链接条件

143
00:08:58,922 --> 00:09:02,842
如果不给on的链接条件,就会出现迪卡尔乘积

144
00:09:02,842 --> 00:09:04,442
答案是A

145
00:09:04,442 --> 00:09:05,322
明白了吧?

146
00:09:05,322 --> 00:09:12,842
好,同学们,那么以上我们就讲解了SQL99中的inner join的使用

147
00:09:12,842 --> 00:09:14,302
好,同学们,我们接接课吧!

